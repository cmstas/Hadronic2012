# STCImplementation background estimates and plots

import ROOT
from math import sqrt
import re
import sys
import os
import subprocess

# Suppresses warnings about TH1::Sumw2
ROOT.gErrorIgnoreLevel = ROOT.kError

verbose = False # Print more status messages

ROOT.gROOT.SetBatch(True)
ROOT.gStyle.SetOptStat(False)
ROOT.gStyle.SetLegendTextSize(0.03)
ROOT.gStyle.SetPaintTextFormat("#3.3g")
ROOT.gStyle.SetLegendBorderSize(0)
simplecanvas = ROOT.TCanvas("plotter")
simplecanvas.SetCanvasSize(1000,600)
simplecanvas.SetTicks(1,1)
simplecanvas.SetLeftMargin(0.16)
simplecanvas.SetTopMargin(0.12)
simplecanvas.SetRightMargin(0.16)
simplecanvas.SetBottomMargin(0.16)

tl=ROOT.TLegend(0.2,0.7,0.4,0.8)

if len(sys.argv) < 3: 
    print "Which syststring?"
    exit()
if len(sys.argv) < 2: 
    print "Which tag?"
    exit()

tag = sys.argv[1]
syststring = sys.argv[2]
tabledir = "region_tables/{}".format(tag)
plotdir = "region_plots/{}".format(tag)
os.system("mkdir -p {}".format(tabledir))
os.system("mkdir -p {}".format(plotdir))

def printHeader(outfile):
    outfile.write("\documentclass[10pt]{article}\n\n")

    outfile.write("\usepackage{amsmath,graphicx,setspace,multirow,booktabs}\n")
    outfile.write("\usepackage[paperheight=14in,paperwidth=14in]{geometry}\n")
    outfile.write("\usepackage[table]{xcolor}\n\n")

    outfile.write("\\addtolength{\\topmargin}{-.875in}\n")
    outfile.write("\\addtolength{\\textheight}{1.75in}\n\n")

    outfile.write("\\addtolength{\oddsidemargin}{-.875in}\n")
    outfile.write("\\addtolength{\evensidemargin}{-.875in}\n")
    outfile.write("\\addtolength{\\textwidth}{1.25in}\n\n")

    outfile.write("\\nofiles\n\n")

    outfile.write("\pagestyle{empty}\n\n")

    outfile.write("\setlength{\parindent}{0in}\n")
    outfile.write("\setlength{\columnsep}{1cm}\n\n")

    outfile.write("\onehalfspacing\n\n")


def startRegionTableData(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *2c | *2c | *2c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{2}{c}{2018 Data} & \multicolumn{2}{c}{2017 Data} & \multicolumn{2}{c}{2016 Data}\\\\ \n")
    outfile.write(" & Pred ST & Obs ST & Pred ST & Obs ST & Pred ST & Obs ST\\\\ \n ")
    outfile.write("\hline\n")

def startRegionTableMC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *2c | *2c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{2}{c}{2017 MC} & \multicolumn{2}{c}{2016 MC}\\\\ \n")
    outfile.write(" & Pred ST & Obs ST & Pred ST & Obs ST \\\\ \n ")
    outfile.write("\hline\n")

def startRegionTableDataSTC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *3c | *3c | *3c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{3}{c}{2018 Data} & \multicolumn{3}{c}{2017 Data} & \multicolumn{3}{c}{2016 Data}\\\\ \n")
    outfile.write(" & STC & Pred ST & Obs ST & STC & Pred ST & Obs ST & STC & Pred ST & Obs ST\\\\ \n ")
    outfile.write("\hline\n")

def startRegionTableMCSTC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *3c | *3c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{3}{c}{2017 MC} & \multicolumn{3}{c}{2016 MC}\\\\ \n")
    outfile.write(" & STC & Pred ST & Obs ST & STC & Pred ST & Obs ST \\\\ \n ")
    outfile.write("\hline\n")

def startFshortTableData(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | c | c | c}\n")
    outfile.write("\\toprule\n")
    outfile.write("Category & 2018 Data & 2017 Data & 2016 Data\\\\ \n")
    outfile.write("\hline\n")

def startFshortTableMC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | c | c}\n")
    outfile.write("\\toprule\n")
    outfile.write("Category & 2017 MC & 2016 MC\\\\ \n")
    outfile.write("\hline\n")

def startMergedRegionTableData(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *2c | *2c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{2}{c}{2017-18 Data} & \multicolumn{2}{c}{2016 Data}\\\\ \n")
    outfile.write(" & Pred ST & Obs ST & Pred ST & Obs ST \\\\ \n ")
    outfile.write("\hline\n")

def startMergedRegionTableMC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *2c | *2c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{2}{c}{2017-18 MC} & \multicolumn{2}{c}{2016 MC}\\\\ \n")
    outfile.write(" & Pred ST & Obs ST & Pred ST & Obs ST \\\\ \n ")
    outfile.write("\hline\n")

def startMergedRegionTableDataSTC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *3c | *3c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{3}{c}{2017-18 Data} & \multicolumn{3}{c}{2016 Data}\\\\ \n")
    outfile.write(" & STC & Pred ST & Obs ST & STC & Pred ST & Obs ST \\\\ \n ")
    outfile.write("\hline\n")

def startMergedRegionTableMCSTC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | *3c | *3c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & \multicolumn{3}{c}{2017-18 MC} & \multicolumn{3}{c}{2016 MC}\\\\ \n")
    outfile.write(" & STC & Pred ST & Obs ST & STC & Pred ST & Obs ST \\\\ \n ")
    outfile.write("\hline\n")

def startMergedFshortTableData(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | c | c}\n")
    outfile.write("\\toprule\n")
    outfile.write("Category & 2017-18 Data & 2016 Data\\\\ \n")
    outfile.write("\hline\n")

def startMergedFshortTableMC(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | c | c}\n")
    outfile.write("\\toprule\n")
    outfile.write("Category & 2017-18 MC & 2016 MC\\\\ \n")
    outfile.write("\hline\n")

def startMergedCountsTable(outfile):
    outfile.write("\\begin{document}\n\n")

    outfile.write("\\begin{tabular}{l | c c | *3c| *3c}\n")
    outfile.write("\\toprule\n")
    outfile.write("\multirow{2}{*}{Region} & 2017-18 Data & 2016 Data & \multicolumn{3}{c}{10 cm Signal} & \multicolumn{3}{c}{90 cm Signal} \\\\ \n")
    outfile.write(" & Pred Background & Pred Background & 1800, 1400 GeV & 1800, 1600 GeV & 1800, 1700 GeV & 1800, 1400 GeV & 1800, 1600 GeV & 1800, 1700 GeV\\\\ \n ")
    outfile.write("\hline\n")

def printFooter(outfile):
    outfile.write("\\bottomrule\n")
    outfile.write("\end{tabular}\n\n")
    outfile.write("\\bigskip\n\n")

    outfile.write("\end{document}\n\n")

def getFshorts(f):
    h_FS = f.Get("h_FS")
    h_FS_23 = f.Get("h_FS_23")
    h_FS_4 = f.Get("h_FS_4")
    h_FS_hi = f.Get("h_FS_hi")
    h_FS_23_hi = f.Get("h_FS_23_hi")
    h_FS_4_hi = f.Get("h_FS_4_hi")
    h_FS_lo = f.Get("h_FS_lo")
    h_FS_23_lo = f.Get("h_FS_23_lo")
    h_FS_4_lo = f.Get("h_FS_4_lo")
    h_FS_syst = f.Get("h_FS_syst")
    h_FS_23_syst = f.Get("h_FS_23_syst")
    h_FS_4_syst = f.Get("h_FS_4_syst")
    h_FS_hi_syst = f.Get("h_FS_hi_syst")
    h_FS_23_hi_syst = f.Get("h_FS_23_hi_syst")
    h_FS_4_hi_syst = f.Get("h_FS_4_hi_syst")
    h_FS_lo_syst = f.Get("h_FS_lo_syst")
    h_FS_23_lo_syst = f.Get("h_FS_23_lo_syst")
    h_FS_4_lo_syst = f.Get("h_FS_4_lo_syst")
    vals = {}
    errs = {}
    systs = {}
    vals["P"] = h_FS.GetBinContent(1)
    vals["P3"] = h_FS.GetBinContent(2)
    vals["P4"] = h_FS.GetBinContent(3)
    vals["M"] = h_FS.GetBinContent(4)
    vals["L"] = h_FS.GetBinContent(5)

    vals["P 23"] = h_FS_23.GetBinContent(1)
    vals["P3 23"] = h_FS_23.GetBinContent(2)
    vals["P4 23"] = h_FS_23.GetBinContent(3)
    vals["M 23"] = h_FS_23.GetBinContent(4)
    vals["L 23"] = h_FS_23.GetBinContent(5)

    vals["P 4"] = h_FS_4.GetBinContent(1)
    vals["P3 4"] = h_FS_4.GetBinContent(2)
    vals["P4 4"] = h_FS_4.GetBinContent(3)
    vals["M 4"] = h_FS_4.GetBinContent(4)
    vals["L 4"] = h_FS_4.GetBinContent(5)

    errs["P"] = h_FS.GetBinError(1)
    errs["P3"] = h_FS.GetBinError(2)
    errs["P4"] = h_FS.GetBinError(3)
    errs["M"] = h_FS.GetBinError(4)
    errs["L"] = h_FS.GetBinError(5)

    errs["P 23"] = h_FS_23.GetBinError(1)
    errs["P3 23"] = h_FS_23.GetBinError(2)
    errs["P4 23"] = h_FS_23.GetBinError(3)
    errs["M 23"] = h_FS_23.GetBinError(4)
    errs["L 23"] = h_FS_23.GetBinError(5)

    errs["P 4"] = h_FS_4.GetBinError(1)
    errs["P3 4"] = h_FS_4.GetBinError(2)
    errs["P4 4"] = h_FS_4.GetBinError(3)
    errs["M 4"] = h_FS_4.GetBinError(4)
    errs["L 4"] = h_FS_4.GetBinError(5)

    systs["P"] = h_FS_syst.GetBinError(1)
    systs["P3"] = h_FS_syst.GetBinError(2)
    systs["P4"] = h_FS_syst.GetBinError(3)
    systs["M"] = h_FS_syst.GetBinError(4)
    systs["L"] = h_FS_syst.GetBinError(5)

    systs["P 23"] = h_FS_23_syst.GetBinError(1)
    systs["P3 23"] = h_FS_23_syst.GetBinError(2)
    systs["P4 23"] = h_FS_23_syst.GetBinError(3)
    systs["M 23"] = h_FS_23_syst.GetBinError(4)
    systs["L 23"] = h_FS_23_syst.GetBinError(5)

    systs["P 4"] = h_FS_4_syst.GetBinError(1)
    systs["P3 4"] = h_FS_4_syst.GetBinError(2)
    systs["P4 4"] = h_FS_4_syst.GetBinError(3)
    systs["M 4"] = h_FS_4_syst.GetBinError(4)
    systs["L 4"] = h_FS_4_syst.GetBinError(5)

    # hi pt
    vals["P hi"] = h_FS_hi.GetBinContent(1)
    vals["P3 hi"] = h_FS_hi.GetBinContent(2)
    vals["P4 hi"] = h_FS_hi.GetBinContent(3)
    vals["M hi"] = h_FS_hi.GetBinContent(4)
    vals["L hi"] = h_FS_hi.GetBinContent(5)

    vals["P 23 hi"] = h_FS_23_hi.GetBinContent(1)
    vals["P3 23 hi"] = h_FS_23_hi.GetBinContent(2)
    vals["P4 23 hi"] = h_FS_23_hi.GetBinContent(3)
    vals["M 23 hi"] = h_FS_23_hi.GetBinContent(4)
    vals["L 23 hi"] = h_FS_23_hi.GetBinContent(5)

    vals["P 4 hi"] = h_FS_4_hi.GetBinContent(1)
    vals["P3 4 hi"] = h_FS_4_hi.GetBinContent(2)
    vals["P4 4 hi"] = h_FS_4_hi.GetBinContent(3)
    vals["M 4 hi"] = h_FS_4_hi.GetBinContent(4)
    vals["L 4 hi"] = h_FS_4_hi.GetBinContent(5)

    errs["P hi"] = h_FS_hi.GetBinError(1)
    errs["P3 hi"] = h_FS_hi.GetBinError(2)
    errs["P4 hi"] = h_FS_hi.GetBinError(3)
    errs["M hi"] = h_FS_hi.GetBinError(4)
    errs["L hi"] = h_FS_hi.GetBinError(5)

    errs["P 23 hi"] = h_FS_23_hi.GetBinError(1)
    errs["P3 23 hi"] = h_FS_23_hi.GetBinError(2)
    errs["P4 23 hi"] = h_FS_23_hi.GetBinError(3)
    errs["M 23 hi"] = h_FS_23_hi.GetBinError(4)
    errs["L 23 hi"] = h_FS_23_hi.GetBinError(5)

    errs["P 4 hi"] = h_FS_4_hi.GetBinError(1)
    errs["P3 4 hi"] = h_FS_4_hi.GetBinError(2)
    errs["P4 4 hi"] = h_FS_4_hi.GetBinError(3)
    errs["M 4 hi"] = h_FS_4_hi.GetBinError(4)
    errs["L 4 hi"] = h_FS_4_hi.GetBinError(5)

    systs["P hi"] = h_FS_hi_syst.GetBinError(1)
    systs["P3 hi"] = h_FS_hi_syst.GetBinError(2)
    systs["P4 hi"] = h_FS_hi_syst.GetBinError(3)
    systs["M hi"] = h_FS_hi_syst.GetBinError(4)
    systs["L hi"] = h_FS_hi_syst.GetBinError(5)

    systs["P 23 hi"] = h_FS_23_hi_syst.GetBinError(1)
    systs["P3 23 hi"] = h_FS_23_hi_syst.GetBinError(2)
    systs["P4 23 hi"] = h_FS_23_hi_syst.GetBinError(3)
    systs["M 23 hi"] = h_FS_23_hi_syst.GetBinError(4)
    systs["L 23 hi"] = h_FS_23_hi_syst.GetBinError(5)

    systs["P 4 hi"] = h_FS_4_hi_syst.GetBinError(1)
    systs["P3 4 hi"] = h_FS_4_hi_syst.GetBinError(2)
    systs["P4 4 hi"] = h_FS_4_hi_syst.GetBinError(3)
    systs["M 4 hi"] = h_FS_4_hi_syst.GetBinError(4)
    systs["L 4 hi"] = h_FS_4_hi_syst.GetBinError(5)


    # lo pt
    vals["P lo"] = h_FS_lo.GetBinContent(1)
    vals["P3 lo"] = h_FS_lo.GetBinContent(2)
    vals["P4 lo"] = h_FS_lo.GetBinContent(3)
    vals["M lo"] = h_FS_lo.GetBinContent(4)
    vals["L lo"] = h_FS_lo.GetBinContent(5)

    vals["P 23 lo"] = h_FS_23_lo.GetBinContent(1)
    vals["P3 23 lo"] = h_FS_23_lo.GetBinContent(2)
    vals["P4 23 lo"] = h_FS_23_lo.GetBinContent(3)
    vals["M 23 lo"] = h_FS_23_lo.GetBinContent(4)
    vals["L 23 lo"] = h_FS_23_lo.GetBinContent(5)

    vals["P 4 lo"] = h_FS_4_lo.GetBinContent(1)
    vals["P3 4 lo"] = h_FS_4_lo.GetBinContent(2)
    vals["P4 4 lo"] = h_FS_4_lo.GetBinContent(3)
    vals["M 4 lo"] = h_FS_4_lo.GetBinContent(4)
    vals["L 4 lo"] = h_FS_4_lo.GetBinContent(5)

    errs["P lo"] = h_FS_lo.GetBinError(1)
    errs["P3 lo"] = h_FS_lo.GetBinError(2)
    errs["P4 lo"] = h_FS_lo.GetBinError(3)
    errs["M lo"] = h_FS_lo.GetBinError(4)
    errs["L lo"] = h_FS_lo.GetBinError(5)

    errs["P 23 lo"] = h_FS_23_lo.GetBinError(1)
    errs["P3 23 lo"] = h_FS_23_lo.GetBinError(2)
    errs["P4 23 lo"] = h_FS_23_lo.GetBinError(3)
    errs["M 23 lo"] = h_FS_23_lo.GetBinError(4)
    errs["L 23 lo"] = h_FS_23_lo.GetBinError(5)

    errs["P 4 lo"] = h_FS_4_lo.GetBinError(1)
    errs["P3 4 lo"] = h_FS_4_lo.GetBinError(2)
    errs["P4 4 lo"] = h_FS_4_lo.GetBinError(3)
    errs["M 4 lo"] = h_FS_4_lo.GetBinError(4)
    errs["L 4 lo"] = h_FS_4_lo.GetBinError(5)

    systs["P lo"] = h_FS_lo_syst.GetBinError(1)
    systs["P3 lo"] = h_FS_lo_syst.GetBinError(2)
    systs["P4 lo"] = h_FS_lo_syst.GetBinError(3)
    systs["M lo"] = h_FS_lo_syst.GetBinError(4)
    systs["L lo"] = h_FS_lo_syst.GetBinError(5)

    systs["P 23 lo"] = h_FS_23_lo_syst.GetBinError(1)
    systs["P3 23 lo"] = h_FS_23_lo_syst.GetBinError(2)
    systs["P4 23 lo"] = h_FS_23_lo_syst.GetBinError(3)
    systs["M 23 lo"] = h_FS_23_lo_syst.GetBinError(4)
    systs["L 23 lo"] = h_FS_23_lo_syst.GetBinError(5)

    systs["P 4 lo"] = h_FS_4_lo_syst.GetBinError(1)
    systs["P3 4 lo"] = h_FS_4_lo_syst.GetBinError(2)
    systs["P4 4 lo"] = h_FS_4_lo_syst.GetBinError(3)
    systs["M 4 lo"] = h_FS_4_lo_syst.GetBinError(4)
    systs["L 4 lo"] = h_FS_4_lo_syst.GetBinError(5)

    return vals,errs,systs

def getCounts(f):
    h_LL_VR_23 = f.Get("h_LL_VR_23")
    h_LM_VR_23 = f.Get("h_LM_VR_23")
    h_LLM_VR_23 = f.Get("h_LLM_VR_23")
    h_LH_VR_23 = f.Get("h_LH_VR_23")
    h_HL_VR_4 = f.Get("h_HL_VR_4")
    h_HLM_VR_4 = f.Get("h_HLM_VR_4")
    h_HM_VR_4 = f.Get("h_HM_VR_4")
    h_HH_VR_4 = f.Get("h_HH_VR_4")
    h_LL_VR_23_hi = f.Get("h_LL_VR_23_hi")
    h_LLM_VR_23_hi = f.Get("h_LLM_VR_23_hi")
    h_LM_VR_23_hi = f.Get("h_LM_VR_23_hi")
    h_LH_VR_23_hi = f.Get("h_LH_VR_23_hi")
    h_HL_VR_4_hi = f.Get("h_HL_VR_4_hi")
    h_HLM_VR_4_hi = f.Get("h_HLM_VR_4_hi")
    h_HM_VR_4_hi = f.Get("h_HM_VR_4_hi")
    h_HH_VR_4_hi = f.Get("h_HH_VR_4_hi")
    h_LL_VR_23_lo = f.Get("h_LL_VR_23_lo")
    h_LLM_VR_23_lo = f.Get("h_LLM_VR_23_lo")
    h_LM_VR_23_lo = f.Get("h_LM_VR_23_lo")
    h_LH_VR_23_lo = f.Get("h_LH_VR_23_lo")
    h_HL_VR_4_lo = f.Get("h_HL_VR_4_lo")
    h_HLM_VR_4_lo = f.Get("h_HLM_VR_4_lo")
    h_HM_VR_4_lo = f.Get("h_HM_VR_4_lo")
    h_HH_VR_4_lo = f.Get("h_HH_VR_4_lo")
    h_LL_SR_23 = f.Get("h_LL_SR_23")
    h_LLM_SR_23 = f.Get("h_LLM_SR_23")
    h_LM_SR_23 = f.Get("h_LM_SR_23")
    h_LH_SR_23 = f.Get("h_LH_SR_23")
    h_HL_SR_4 = f.Get("h_HL_SR_4")
    h_HLM_SR_4 = f.Get("h_HLM_SR_4")
    h_HM_SR_4 = f.Get("h_HM_SR_4")
    h_HH_SR_4 = f.Get("h_HH_SR_4")
    h_LL_SR_23_hi = f.Get("h_LL_SR_23_hi")
    h_LLM_SR_23_hi = f.Get("h_LLM_SR_23_hi")
    h_LM_SR_23_hi = f.Get("h_LM_SR_23_hi")
    h_LH_SR_23_hi = f.Get("h_LH_SR_23_hi")
    h_HL_SR_4_hi = f.Get("h_HL_SR_4_hi")
    h_HLM_SR_4_hi = f.Get("h_HLM_SR_4_hi")
    h_HM_SR_4_hi = f.Get("h_HM_SR_4_hi")
    h_HH_SR_4_hi = f.Get("h_HH_SR_4_hi")
    h_LL_SR_23_lo = f.Get("h_LL_SR_23_lo")
    h_LLM_SR_23_lo = f.Get("h_LLM_SR_23_lo")
    h_LM_SR_23_lo = f.Get("h_LM_SR_23_lo")
    h_LH_SR_23_lo = f.Get("h_LH_SR_23_lo")
    h_HL_SR_4_lo = f.Get("h_HL_SR_4_lo")
    h_HLM_SR_4_lo = f.Get("h_HLM_SR_4_lo")
    h_HM_SR_4_lo = f.Get("h_HM_SR_4_lo")
    h_HH_SR_4_lo = f.Get("h_HH_SR_4_lo")
    vals = {}
    errs = {}
    # VR vals
    vals["P LL VR STC"] = h_LL_VR_23.GetBinContent(1,3)
    vals["P LL VR pre"] = h_LL_VR_23.GetBinContent(1,2)
    vals["P LL VR obs"] = h_LL_VR_23.GetBinContent(1,1)
    vals["P3 LL VR STC"] = h_LL_VR_23.GetBinContent(2,3)
    vals["P3 LL VR pre"] = h_LL_VR_23.GetBinContent(2,2)
    vals["P3 LL VR obs"] = h_LL_VR_23.GetBinContent(2,1)
    vals["P4 LL VR STC"] = h_LL_VR_23.GetBinContent(3,3)
    vals["P4 LL VR pre"] = h_LL_VR_23.GetBinContent(3,2)
    vals["P4 LL VR obs"] = h_LL_VR_23.GetBinContent(3,1)
    vals["M LL VR STC"] = h_LL_VR_23.GetBinContent(4,3)
    vals["M LL VR pre"] = h_LL_VR_23.GetBinContent(4,2)
    vals["M LL VR obs"] = h_LL_VR_23.GetBinContent(4,1)
    vals["L LL VR STC"] = h_LL_VR_23.GetBinContent(5,3)
    vals["L LL VR pre"] = h_LL_VR_23.GetBinContent(5,2)
    vals["L LL VR obs"] = h_LL_VR_23.GetBinContent(5,1)

    vals["P LLM VR STC"] = h_LLM_VR_23.GetBinContent(1,3)
    vals["P LLM VR pre"] = h_LLM_VR_23.GetBinContent(1,2)
    vals["P LLM VR obs"] = h_LLM_VR_23.GetBinContent(1,1)
    vals["P3 LLM VR STC"] = h_LLM_VR_23.GetBinContent(2,3)
    vals["P3 LLM VR pre"] = h_LLM_VR_23.GetBinContent(2,2)
    vals["P3 LLM VR obs"] = h_LLM_VR_23.GetBinContent(2,1)
    vals["P4 LLM VR STC"] = h_LLM_VR_23.GetBinContent(3,3)
    vals["P4 LLM VR pre"] = h_LLM_VR_23.GetBinContent(3,2)
    vals["P4 LLM VR obs"] = h_LLM_VR_23.GetBinContent(3,1)
    vals["M LLM VR STC"] = h_LLM_VR_23.GetBinContent(4,3)
    vals["M LLM VR pre"] = h_LLM_VR_23.GetBinContent(4,2)
    vals["M LLM VR obs"] = h_LLM_VR_23.GetBinContent(4,1)
    vals["L LLM VR STC"] = h_LLM_VR_23.GetBinContent(5,3)
    vals["L LLM VR pre"] = h_LLM_VR_23.GetBinContent(5,2)
    vals["L LLM VR obs"] = h_LLM_VR_23.GetBinContent(5,1)

    vals["P LM VR STC"] = h_LM_VR_23.GetBinContent(1,3)
    vals["P LM VR pre"] = h_LM_VR_23.GetBinContent(1,2)
    vals["P LM VR obs"] = h_LM_VR_23.GetBinContent(1,1)
    vals["P3 LM VR STC"] = h_LM_VR_23.GetBinContent(2,3)
    vals["P3 LM VR pre"] = h_LM_VR_23.GetBinContent(2,2)
    vals["P3 LM VR obs"] = h_LM_VR_23.GetBinContent(2,1)
    vals["P4 LM VR STC"] = h_LM_VR_23.GetBinContent(3,3)
    vals["P4 LM VR pre"] = h_LM_VR_23.GetBinContent(3,2)
    vals["P4 LM VR obs"] = h_LM_VR_23.GetBinContent(3,1)
    vals["M LM VR STC"] = h_LM_VR_23.GetBinContent(4,3)
    vals["M LM VR pre"] = h_LM_VR_23.GetBinContent(4,2)
    vals["M LM VR obs"] = h_LM_VR_23.GetBinContent(4,1)
    vals["L LM VR STC"] = h_LM_VR_23.GetBinContent(5,3)
    vals["L LM VR pre"] = h_LM_VR_23.GetBinContent(5,2)
    vals["L LM VR obs"] = h_LM_VR_23.GetBinContent(5,1)

    vals["P LH VR STC"] = h_LH_VR_23.GetBinContent(1,3)
    vals["P LH VR pre"] = h_LH_VR_23.GetBinContent(1,2)
    vals["P LH VR obs"] = h_LH_VR_23.GetBinContent(1,1)
    vals["P3 LH VR STC"] = h_LH_VR_23.GetBinContent(2,3)
    vals["P3 LH VR pre"] = h_LH_VR_23.GetBinContent(2,2)
    vals["P3 LH VR obs"] = h_LH_VR_23.GetBinContent(2,1)
    vals["P4 LH VR STC"] = h_LH_VR_23.GetBinContent(3,3)
    vals["P4 LH VR pre"] = h_LH_VR_23.GetBinContent(3,2)
    vals["P4 LH VR obs"] = h_LH_VR_23.GetBinContent(3,1)
    vals["M LH VR STC"] = h_LH_VR_23.GetBinContent(4,3)
    vals["M LH VR pre"] = h_LH_VR_23.GetBinContent(4,2)
    vals["M LH VR obs"] = h_LH_VR_23.GetBinContent(4,1)
    vals["L LH VR STC"] = h_LH_VR_23.GetBinContent(5,3)
    vals["L LH VR pre"] = h_LH_VR_23.GetBinContent(5,2)
    vals["L LH VR obs"] = h_LH_VR_23.GetBinContent(5,1)

    vals["P HL VR STC"] = h_HL_VR_4.GetBinContent(1,3)
    vals["P HL VR pre"] = h_HL_VR_4.GetBinContent(1,2)
    vals["P HL VR obs"] = h_HL_VR_4.GetBinContent(1,1)
    vals["P3 HL VR STC"] = h_HL_VR_4.GetBinContent(2,3)
    vals["P3 HL VR pre"] = h_HL_VR_4.GetBinContent(2,2)
    vals["P3 HL VR obs"] = h_HL_VR_4.GetBinContent(2,1)
    vals["P4 HL VR STC"] = h_HL_VR_4.GetBinContent(3,3)
    vals["P4 HL VR pre"] = h_HL_VR_4.GetBinContent(3,2)
    vals["P4 HL VR obs"] = h_HL_VR_4.GetBinContent(3,1)
    vals["M HL VR STC"] = h_HL_VR_4.GetBinContent(4,3)
    vals["M HL VR pre"] = h_HL_VR_4.GetBinContent(4,2)
    vals["M HL VR obs"] = h_HL_VR_4.GetBinContent(4,1)
    vals["L HL VR STC"] = h_HL_VR_4.GetBinContent(5,3)
    vals["L HL VR pre"] = h_HL_VR_4.GetBinContent(5,2)
    vals["L HL VR obs"] = h_HL_VR_4.GetBinContent(5,1)

    vals["P HLM VR STC"] = h_HLM_VR_4.GetBinContent(1,3)
    vals["P HLM VR pre"] = h_HLM_VR_4.GetBinContent(1,2)
    vals["P HLM VR obs"] = h_HLM_VR_4.GetBinContent(1,1)
    vals["P3 HLM VR STC"] = h_HLM_VR_4.GetBinContent(2,3)
    vals["P3 HLM VR pre"] = h_HLM_VR_4.GetBinContent(2,2)
    vals["P3 HLM VR obs"] = h_HLM_VR_4.GetBinContent(2,1)
    vals["P4 HLM VR STC"] = h_HLM_VR_4.GetBinContent(3,3)
    vals["P4 HLM VR pre"] = h_HLM_VR_4.GetBinContent(3,2)
    vals["P4 HLM VR obs"] = h_HLM_VR_4.GetBinContent(3,1)
    vals["M HLM VR STC"] = h_HLM_VR_4.GetBinContent(4,3)
    vals["M HLM VR pre"] = h_HLM_VR_4.GetBinContent(4,2)
    vals["M HLM VR obs"] = h_HLM_VR_4.GetBinContent(4,1)
    vals["L HLM VR STC"] = h_HLM_VR_4.GetBinContent(5,3)
    vals["L HLM VR pre"] = h_HLM_VR_4.GetBinContent(5,2)
    vals["L HLM VR obs"] = h_HLM_VR_4.GetBinContent(5,1)

    vals["P HM VR STC"] = h_HM_VR_4.GetBinContent(1,3)
    vals["P HM VR pre"] = h_HM_VR_4.GetBinContent(1,2)
    vals["P HM VR obs"] = h_HM_VR_4.GetBinContent(1,1)
    vals["P3 HM VR STC"] = h_HM_VR_4.GetBinContent(2,3)
    vals["P3 HM VR pre"] = h_HM_VR_4.GetBinContent(2,2)
    vals["P3 HM VR obs"] = h_HM_VR_4.GetBinContent(2,1)
    vals["P4 HM VR STC"] = h_HM_VR_4.GetBinContent(3,3)
    vals["P4 HM VR pre"] = h_HM_VR_4.GetBinContent(3,2)
    vals["P4 HM VR obs"] = h_HM_VR_4.GetBinContent(3,1)
    vals["M HM VR STC"] = h_HM_VR_4.GetBinContent(4,3)
    vals["M HM VR pre"] = h_HM_VR_4.GetBinContent(4,2)
    vals["M HM VR obs"] = h_HM_VR_4.GetBinContent(4,1)
    vals["L HM VR STC"] = h_HM_VR_4.GetBinContent(5,3)
    vals["L HM VR pre"] = h_HM_VR_4.GetBinContent(5,2)
    vals["L HM VR obs"] = h_HM_VR_4.GetBinContent(5,1)

    vals["P HH VR STC"] = h_HH_VR_4.GetBinContent(1,3)
    vals["P HH VR pre"] = h_HH_VR_4.GetBinContent(1,2)
    vals["P HH VR obs"] = h_HH_VR_4.GetBinContent(1,1)
    vals["P3 HH VR STC"] = h_HH_VR_4.GetBinContent(2,3)
    vals["P3 HH VR pre"] = h_HH_VR_4.GetBinContent(2,2)
    vals["P3 HH VR obs"] = h_HH_VR_4.GetBinContent(2,1)
    vals["P4 HH VR STC"] = h_HH_VR_4.GetBinContent(3,3)
    vals["P4 HH VR pre"] = h_HH_VR_4.GetBinContent(3,2)
    vals["P4 HH VR obs"] = h_HH_VR_4.GetBinContent(3,1)
    vals["M HH VR STC"] = h_HH_VR_4.GetBinContent(4,3)
    vals["M HH VR pre"] = h_HH_VR_4.GetBinContent(4,2)
    vals["M HH VR obs"] = h_HH_VR_4.GetBinContent(4,1)
    vals["L HH VR STC"] = h_HH_VR_4.GetBinContent(5,3)
    vals["L HH VR pre"] = h_HH_VR_4.GetBinContent(5,2)
    vals["L HH VR obs"] = h_HH_VR_4.GetBinContent(5,1)

    # hi pt
    vals["P LL VR hi STC"] = h_LL_VR_23_hi.GetBinContent(1,3)
    vals["P LL VR hi pre"] = h_LL_VR_23_hi.GetBinContent(1,2)
    vals["P LL VR hi obs"] = h_LL_VR_23_hi.GetBinContent(1,1)
    vals["P3 LL VR hi STC"] = h_LL_VR_23_hi.GetBinContent(2,3)
    vals["P3 LL VR hi pre"] = h_LL_VR_23_hi.GetBinContent(2,2)
    vals["P3 LL VR hi obs"] = h_LL_VR_23_hi.GetBinContent(2,1)
    vals["P4 LL VR hi STC"] = h_LL_VR_23_hi.GetBinContent(3,3)
    vals["P4 LL VR hi pre"] = h_LL_VR_23_hi.GetBinContent(3,2)
    vals["P4 LL VR hi obs"] = h_LL_VR_23_hi.GetBinContent(3,1)
    vals["M LL VR hi STC"] = h_LL_VR_23_hi.GetBinContent(4,3)
    vals["M LL VR hi pre"] = h_LL_VR_23_hi.GetBinContent(4,2)
    vals["M LL VR hi obs"] = h_LL_VR_23_hi.GetBinContent(4,1)
    vals["L LL VR hi STC"] = h_LL_VR_23_hi.GetBinContent(5,3)
    vals["L LL VR hi pre"] = h_LL_VR_23_hi.GetBinContent(5,2)
    vals["L LL VR hi obs"] = h_LL_VR_23_hi.GetBinContent(5,1)

    vals["P LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinContent(1,3)
    vals["P LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinContent(1,2)
    vals["P LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinContent(1,1)
    vals["P3 LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinContent(2,3)
    vals["P3 LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinContent(2,2)
    vals["P3 LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinContent(2,1)
    vals["P4 LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinContent(3,3)
    vals["P4 LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinContent(3,2)
    vals["P4 LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinContent(3,1)
    vals["M LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinContent(4,3)
    vals["M LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinContent(4,2)
    vals["M LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinContent(4,1)
    vals["L LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinContent(5,3)
    vals["L LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinContent(5,2)
    vals["L LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinContent(5,1)

    vals["P LM VR hi STC"] = h_LM_VR_23_hi.GetBinContent(1,3)
    vals["P LM VR hi pre"] = h_LM_VR_23_hi.GetBinContent(1,2)
    vals["P LM VR hi obs"] = h_LM_VR_23_hi.GetBinContent(1,1)
    vals["P3 LM VR hi STC"] = h_LM_VR_23_hi.GetBinContent(2,3)
    vals["P3 LM VR hi pre"] = h_LM_VR_23_hi.GetBinContent(2,2)
    vals["P3 LM VR hi obs"] = h_LM_VR_23_hi.GetBinContent(2,1)
    vals["P4 LM VR hi STC"] = h_LM_VR_23_hi.GetBinContent(3,3)
    vals["P4 LM VR hi pre"] = h_LM_VR_23_hi.GetBinContent(3,2)
    vals["P4 LM VR hi obs"] = h_LM_VR_23_hi.GetBinContent(3,1)
    vals["M LM VR hi STC"] = h_LM_VR_23_hi.GetBinContent(4,3)
    vals["M LM VR hi pre"] = h_LM_VR_23_hi.GetBinContent(4,2)
    vals["M LM VR hi obs"] = h_LM_VR_23_hi.GetBinContent(4,1)
    vals["L LM VR hi STC"] = h_LM_VR_23_hi.GetBinContent(5,3)
    vals["L LM VR hi pre"] = h_LM_VR_23_hi.GetBinContent(5,2)
    vals["L LM VR hi obs"] = h_LM_VR_23_hi.GetBinContent(5,1)

    vals["P LH VR hi STC"] = h_LH_VR_23_hi.GetBinContent(1,3)
    vals["P LH VR hi pre"] = h_LH_VR_23_hi.GetBinContent(1,2)
    vals["P LH VR hi obs"] = h_LH_VR_23_hi.GetBinContent(1,1)
    vals["P3 LH VR hi STC"] = h_LH_VR_23_hi.GetBinContent(2,3)
    vals["P3 LH VR hi pre"] = h_LH_VR_23_hi.GetBinContent(2,2)
    vals["P3 LH VR hi obs"] = h_LH_VR_23_hi.GetBinContent(2,1)
    vals["P4 LH VR hi STC"] = h_LH_VR_23_hi.GetBinContent(3,3)
    vals["P4 LH VR hi pre"] = h_LH_VR_23_hi.GetBinContent(3,2)
    vals["P4 LH VR hi obs"] = h_LH_VR_23_hi.GetBinContent(3,1)
    vals["M LH VR hi STC"] = h_LH_VR_23_hi.GetBinContent(4,3)
    vals["M LH VR hi pre"] = h_LH_VR_23_hi.GetBinContent(4,2)
    vals["M LH VR hi obs"] = h_LH_VR_23_hi.GetBinContent(4,1)
    vals["L LH VR hi STC"] = h_LH_VR_23_hi.GetBinContent(5,3)
    vals["L LH VR hi pre"] = h_LH_VR_23_hi.GetBinContent(5,2)
    vals["L LH VR hi obs"] = h_LH_VR_23_hi.GetBinContent(5,1)

    vals["P HL VR hi STC"] = h_HL_VR_4_hi.GetBinContent(1,3)
    vals["P HL VR hi pre"] = h_HL_VR_4_hi.GetBinContent(1,2)
    vals["P HL VR hi obs"] = h_HL_VR_4_hi.GetBinContent(1,1)
    vals["P3 HL VR hi STC"] = h_HL_VR_4_hi.GetBinContent(2,3)
    vals["P3 HL VR hi pre"] = h_HL_VR_4_hi.GetBinContent(2,2)
    vals["P3 HL VR hi obs"] = h_HL_VR_4_hi.GetBinContent(2,1)
    vals["P4 HL VR hi STC"] = h_HL_VR_4_hi.GetBinContent(3,3)
    vals["P4 HL VR hi pre"] = h_HL_VR_4_hi.GetBinContent(3,2)
    vals["P4 HL VR hi obs"] = h_HL_VR_4_hi.GetBinContent(3,1)
    vals["M HL VR hi STC"] = h_HL_VR_4_hi.GetBinContent(4,3)
    vals["M HL VR hi pre"] = h_HL_VR_4_hi.GetBinContent(4,2)
    vals["M HL VR hi obs"] = h_HL_VR_4_hi.GetBinContent(4,1)
    vals["L HL VR hi STC"] = h_HL_VR_4_hi.GetBinContent(5,3)
    vals["L HL VR hi pre"] = h_HL_VR_4_hi.GetBinContent(5,2)
    vals["L HL VR hi obs"] = h_HL_VR_4_hi.GetBinContent(5,1)

    vals["P HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinContent(1,3)
    vals["P HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinContent(1,2)
    vals["P HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinContent(1,1)
    vals["P3 HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinContent(2,3)
    vals["P3 HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinContent(2,2)
    vals["P3 HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinContent(2,1)
    vals["P4 HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinContent(3,3)
    vals["P4 HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinContent(3,2)
    vals["P4 HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinContent(3,1)
    vals["M HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinContent(4,3)
    vals["M HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinContent(4,2)
    vals["M HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinContent(4,1)
    vals["L HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinContent(5,3)
    vals["L HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinContent(5,2)
    vals["L HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinContent(5,1)

    vals["P HM VR hi STC"] = h_HM_VR_4_hi.GetBinContent(1,3)
    vals["P HM VR hi pre"] = h_HM_VR_4_hi.GetBinContent(1,2)
    vals["P HM VR hi obs"] = h_HM_VR_4_hi.GetBinContent(1,1)
    vals["P3 HM VR hi STC"] = h_HM_VR_4_hi.GetBinContent(2,3)
    vals["P3 HM VR hi pre"] = h_HM_VR_4_hi.GetBinContent(2,2)
    vals["P3 HM VR hi obs"] = h_HM_VR_4_hi.GetBinContent(2,1)
    vals["P4 HM VR hi STC"] = h_HM_VR_4_hi.GetBinContent(3,3)
    vals["P4 HM VR hi pre"] = h_HM_VR_4_hi.GetBinContent(3,2)
    vals["P4 HM VR hi obs"] = h_HM_VR_4_hi.GetBinContent(3,1)
    vals["M HM VR hi STC"] = h_HM_VR_4_hi.GetBinContent(4,3)
    vals["M HM VR hi pre"] = h_HM_VR_4_hi.GetBinContent(4,2)
    vals["M HM VR hi obs"] = h_HM_VR_4_hi.GetBinContent(4,1)
    vals["L HM VR hi STC"] = h_HM_VR_4_hi.GetBinContent(5,3)
    vals["L HM VR hi pre"] = h_HM_VR_4_hi.GetBinContent(5,2)
    vals["L HM VR hi obs"] = h_HM_VR_4_hi.GetBinContent(5,1)

    vals["P HH VR hi STC"] = h_HH_VR_4_hi.GetBinContent(1,3)
    vals["P HH VR hi pre"] = h_HH_VR_4_hi.GetBinContent(1,2)
    vals["P HH VR hi obs"] = h_HH_VR_4_hi.GetBinContent(1,1)
    vals["P3 HH VR hi STC"] = h_HH_VR_4_hi.GetBinContent(2,3)
    vals["P3 HH VR hi pre"] = h_HH_VR_4_hi.GetBinContent(2,2)
    vals["P3 HH VR hi obs"] = h_HH_VR_4_hi.GetBinContent(2,1)
    vals["P4 HH VR hi STC"] = h_HH_VR_4_hi.GetBinContent(3,3)
    vals["P4 HH VR hi pre"] = h_HH_VR_4_hi.GetBinContent(3,2)
    vals["P4 HH VR hi obs"] = h_HH_VR_4_hi.GetBinContent(3,1)
    vals["M HH VR hi STC"] = h_HH_VR_4_hi.GetBinContent(4,3)
    vals["M HH VR hi pre"] = h_HH_VR_4_hi.GetBinContent(4,2)
    vals["M HH VR hi obs"] = h_HH_VR_4_hi.GetBinContent(4,1)
    vals["L HH VR hi STC"] = h_HH_VR_4_hi.GetBinContent(5,3)
    vals["L HH VR hi pre"] = h_HH_VR_4_hi.GetBinContent(5,2)
    vals["L HH VR hi obs"] = h_HH_VR_4_hi.GetBinContent(5,1)

    # lo pt
    vals["P LL VR lo STC"] = h_LL_VR_23_lo.GetBinContent(1,3)
    vals["P LL VR lo pre"] = h_LL_VR_23_lo.GetBinContent(1,2)
    vals["P LL VR lo obs"] = h_LL_VR_23_lo.GetBinContent(1,1)
    vals["P3 LL VR lo STC"] = h_LL_VR_23_lo.GetBinContent(2,3)
    vals["P3 LL VR lo pre"] = h_LL_VR_23_lo.GetBinContent(2,2)
    vals["P3 LL VR lo obs"] = h_LL_VR_23_lo.GetBinContent(2,1)
    vals["P4 LL VR lo STC"] = h_LL_VR_23_lo.GetBinContent(3,3)
    vals["P4 LL VR lo pre"] = h_LL_VR_23_lo.GetBinContent(3,2)
    vals["P4 LL VR lo obs"] = h_LL_VR_23_lo.GetBinContent(3,1)
    vals["M LL VR lo STC"] = h_LL_VR_23_lo.GetBinContent(4,3)
    vals["M LL VR lo pre"] = h_LL_VR_23_lo.GetBinContent(4,2)
    vals["M LL VR lo obs"] = h_LL_VR_23_lo.GetBinContent(4,1)
    vals["L LL VR lo STC"] = h_LL_VR_23_lo.GetBinContent(5,3)
    vals["L LL VR lo pre"] = h_LL_VR_23_lo.GetBinContent(5,2)
    vals["L LL VR lo obs"] = h_LL_VR_23_lo.GetBinContent(5,1)

    vals["P LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinContent(1,3)
    vals["P LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinContent(1,2)
    vals["P LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinContent(1,1)
    vals["P3 LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinContent(2,3)
    vals["P3 LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinContent(2,2)
    vals["P3 LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinContent(2,1)
    vals["P4 LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinContent(3,3)
    vals["P4 LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinContent(3,2)
    vals["P4 LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinContent(3,1)
    vals["M LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinContent(4,3)
    vals["M LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinContent(4,2)
    vals["M LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinContent(4,1)
    vals["L LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinContent(5,3)
    vals["L LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinContent(5,2)
    vals["L LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinContent(5,1)

    vals["P LM VR lo STC"] = h_LM_VR_23_lo.GetBinContent(1,3)
    vals["P LM VR lo pre"] = h_LM_VR_23_lo.GetBinContent(1,2)
    vals["P LM VR lo obs"] = h_LM_VR_23_lo.GetBinContent(1,1)
    vals["P3 LM VR lo STC"] = h_LM_VR_23_lo.GetBinContent(2,3)
    vals["P3 LM VR lo pre"] = h_LM_VR_23_lo.GetBinContent(2,2)
    vals["P3 LM VR lo obs"] = h_LM_VR_23_lo.GetBinContent(2,1)
    vals["P4 LM VR lo STC"] = h_LM_VR_23_lo.GetBinContent(3,3)
    vals["P4 LM VR lo pre"] = h_LM_VR_23_lo.GetBinContent(3,2)
    vals["P4 LM VR lo obs"] = h_LM_VR_23_lo.GetBinContent(3,1)
    vals["M LM VR lo STC"] = h_LM_VR_23_lo.GetBinContent(4,3)
    vals["M LM VR lo pre"] = h_LM_VR_23_lo.GetBinContent(4,2)
    vals["M LM VR lo obs"] = h_LM_VR_23_lo.GetBinContent(4,1)
    vals["L LM VR lo STC"] = h_LM_VR_23_lo.GetBinContent(5,3)
    vals["L LM VR lo pre"] = h_LM_VR_23_lo.GetBinContent(5,2)
    vals["L LM VR lo obs"] = h_LM_VR_23_lo.GetBinContent(5,1)

    vals["P LH VR lo STC"] = h_LH_VR_23_lo.GetBinContent(1,3)
    vals["P LH VR lo pre"] = h_LH_VR_23_lo.GetBinContent(1,2)
    vals["P LH VR lo obs"] = h_LH_VR_23_lo.GetBinContent(1,1)
    vals["P3 LH VR lo STC"] = h_LH_VR_23_lo.GetBinContent(2,3)
    vals["P3 LH VR lo pre"] = h_LH_VR_23_lo.GetBinContent(2,2)
    vals["P3 LH VR lo obs"] = h_LH_VR_23_lo.GetBinContent(2,1)
    vals["P4 LH VR lo STC"] = h_LH_VR_23_lo.GetBinContent(3,3)
    vals["P4 LH VR lo pre"] = h_LH_VR_23_lo.GetBinContent(3,2)
    vals["P4 LH VR lo obs"] = h_LH_VR_23_lo.GetBinContent(3,1)
    vals["M LH VR lo STC"] = h_LH_VR_23_lo.GetBinContent(4,3)
    vals["M LH VR lo pre"] = h_LH_VR_23_lo.GetBinContent(4,2)
    vals["M LH VR lo obs"] = h_LH_VR_23_lo.GetBinContent(4,1)
    vals["L LH VR lo STC"] = h_LH_VR_23_lo.GetBinContent(5,3)
    vals["L LH VR lo pre"] = h_LH_VR_23_lo.GetBinContent(5,2)
    vals["L LH VR lo obs"] = h_LH_VR_23_lo.GetBinContent(5,1)

    vals["P HL VR lo STC"] = h_HL_VR_4_lo.GetBinContent(1,3)
    vals["P HL VR lo pre"] = h_HL_VR_4_lo.GetBinContent(1,2)
    vals["P HL VR lo obs"] = h_HL_VR_4_lo.GetBinContent(1,1)
    vals["P3 HL VR lo STC"] = h_HL_VR_4_lo.GetBinContent(2,3)
    vals["P3 HL VR lo pre"] = h_HL_VR_4_lo.GetBinContent(2,2)
    vals["P3 HL VR lo obs"] = h_HL_VR_4_lo.GetBinContent(2,1)
    vals["P4 HL VR lo STC"] = h_HL_VR_4_lo.GetBinContent(3,3)
    vals["P4 HL VR lo pre"] = h_HL_VR_4_lo.GetBinContent(3,2)
    vals["P4 HL VR lo obs"] = h_HL_VR_4_lo.GetBinContent(3,1)
    vals["M HL VR lo STC"] = h_HL_VR_4_lo.GetBinContent(4,3)
    vals["M HL VR lo pre"] = h_HL_VR_4_lo.GetBinContent(4,2)
    vals["M HL VR lo obs"] = h_HL_VR_4_lo.GetBinContent(4,1)
    vals["L HL VR lo STC"] = h_HL_VR_4_lo.GetBinContent(5,3)
    vals["L HL VR lo pre"] = h_HL_VR_4_lo.GetBinContent(5,2)
    vals["L HL VR lo obs"] = h_HL_VR_4_lo.GetBinContent(5,1)

    vals["P HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinContent(1,3)
    vals["P HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinContent(1,2)
    vals["P HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinContent(1,1)
    vals["P3 HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinContent(2,3)
    vals["P3 HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinContent(2,2)
    vals["P3 HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinContent(2,1)
    vals["P4 HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinContent(3,3)
    vals["P4 HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinContent(3,2)
    vals["P4 HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinContent(3,1)
    vals["M HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinContent(4,3)
    vals["M HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinContent(4,2)
    vals["M HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinContent(4,1)
    vals["L HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinContent(5,3)
    vals["L HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinContent(5,2)
    vals["L HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinContent(5,1)

    vals["P HM VR lo STC"] = h_HM_VR_4_lo.GetBinContent(1,3)
    vals["P HM VR lo pre"] = h_HM_VR_4_lo.GetBinContent(1,2)
    vals["P HM VR lo obs"] = h_HM_VR_4_lo.GetBinContent(1,1)
    vals["P3 HM VR lo STC"] = h_HM_VR_4_lo.GetBinContent(2,3)
    vals["P3 HM VR lo pre"] = h_HM_VR_4_lo.GetBinContent(2,2)
    vals["P3 HM VR lo obs"] = h_HM_VR_4_lo.GetBinContent(2,1)
    vals["P4 HM VR lo STC"] = h_HM_VR_4_lo.GetBinContent(3,3)
    vals["P4 HM VR lo pre"] = h_HM_VR_4_lo.GetBinContent(3,2)
    vals["P4 HM VR lo obs"] = h_HM_VR_4_lo.GetBinContent(3,1)
    vals["M HM VR lo STC"] = h_HM_VR_4_lo.GetBinContent(4,3)
    vals["M HM VR lo pre"] = h_HM_VR_4_lo.GetBinContent(4,2)
    vals["M HM VR lo obs"] = h_HM_VR_4_lo.GetBinContent(4,1)
    vals["L HM VR lo STC"] = h_HM_VR_4_lo.GetBinContent(5,3)
    vals["L HM VR lo pre"] = h_HM_VR_4_lo.GetBinContent(5,2)
    vals["L HM VR lo obs"] = h_HM_VR_4_lo.GetBinContent(5,1)

    vals["P HH VR lo STC"] = h_HH_VR_4_lo.GetBinContent(1,3)
    vals["P HH VR lo pre"] = h_HH_VR_4_lo.GetBinContent(1,2)
    vals["P HH VR lo obs"] = h_HH_VR_4_lo.GetBinContent(1,1)
    vals["P3 HH VR lo STC"] = h_HH_VR_4_lo.GetBinContent(2,3)
    vals["P3 HH VR lo pre"] = h_HH_VR_4_lo.GetBinContent(2,2)
    vals["P3 HH VR lo obs"] = h_HH_VR_4_lo.GetBinContent(2,1)
    vals["P4 HH VR lo STC"] = h_HH_VR_4_lo.GetBinContent(3,3)
    vals["P4 HH VR lo pre"] = h_HH_VR_4_lo.GetBinContent(3,2)
    vals["P4 HH VR lo obs"] = h_HH_VR_4_lo.GetBinContent(3,1)
    vals["M HH VR lo STC"] = h_HH_VR_4_lo.GetBinContent(4,3)
    vals["M HH VR lo pre"] = h_HH_VR_4_lo.GetBinContent(4,2)
    vals["M HH VR lo obs"] = h_HH_VR_4_lo.GetBinContent(4,1)
    vals["L HH VR lo STC"] = h_HH_VR_4_lo.GetBinContent(5,3)
    vals["L HH VR lo pre"] = h_HH_VR_4_lo.GetBinContent(5,2)
    vals["L HH VR lo obs"] = h_HH_VR_4_lo.GetBinContent(5,1)

    # VR Errors
    errs["P LL VR STC"] = h_LL_VR_23.GetBinError(1,3)
    errs["P LL VR pre"] = h_LL_VR_23.GetBinError(1,2)
    errs["P LL VR obs"] = h_LL_VR_23.GetBinError(1,1)
    errs["P3 LL VR STC"] = h_LL_VR_23.GetBinError(2,3)
    errs["P3 LL VR pre"] = h_LL_VR_23.GetBinError(2,2)
    errs["P3 LL VR obs"] = h_LL_VR_23.GetBinError(2,1)
    errs["P4 LL VR STC"] = h_LL_VR_23.GetBinError(3,3)
    errs["P4 LL VR pre"] = h_LL_VR_23.GetBinError(3,2)
    errs["P4 LL VR obs"] = h_LL_VR_23.GetBinError(3,1)
    errs["M LL VR STC"] = h_LL_VR_23.GetBinError(4,3)
    errs["M LL VR pre"] = h_LL_VR_23.GetBinError(4,2)
    errs["M LL VR obs"] = h_LL_VR_23.GetBinError(4,1)
    errs["L LL VR STC"] = h_LL_VR_23.GetBinError(5,3)
    errs["L LL VR pre"] = h_LL_VR_23.GetBinError(5,2)
    errs["L LL VR obs"] = h_LL_VR_23.GetBinError(5,1)

    errs["P LLM VR STC"] = h_LLM_VR_23.GetBinError(1,3)
    errs["P LLM VR pre"] = h_LLM_VR_23.GetBinError(1,2)
    errs["P LLM VR obs"] = h_LLM_VR_23.GetBinError(1,1)
    errs["P3 LLM VR STC"] = h_LLM_VR_23.GetBinError(2,3)
    errs["P3 LLM VR pre"] = h_LLM_VR_23.GetBinError(2,2)
    errs["P3 LLM VR obs"] = h_LLM_VR_23.GetBinError(2,1)
    errs["P4 LLM VR STC"] = h_LLM_VR_23.GetBinError(3,3)
    errs["P4 LLM VR pre"] = h_LLM_VR_23.GetBinError(3,2)
    errs["P4 LLM VR obs"] = h_LLM_VR_23.GetBinError(3,1)
    errs["M LLM VR STC"] = h_LLM_VR_23.GetBinError(4,3)
    errs["M LLM VR pre"] = h_LLM_VR_23.GetBinError(4,2)
    errs["M LLM VR obs"] = h_LLM_VR_23.GetBinError(4,1)
    errs["L LLM VR STC"] = h_LLM_VR_23.GetBinError(5,3)
    errs["L LLM VR pre"] = h_LLM_VR_23.GetBinError(5,2)
    errs["L LLM VR obs"] = h_LLM_VR_23.GetBinError(5,1)

    errs["P LM VR STC"] = h_LM_VR_23.GetBinError(1,3)
    errs["P LM VR pre"] = h_LM_VR_23.GetBinError(1,2)
    errs["P LM VR obs"] = h_LM_VR_23.GetBinError(1,1)
    errs["P3 LM VR STC"] = h_LM_VR_23.GetBinError(2,3)
    errs["P3 LM VR pre"] = h_LM_VR_23.GetBinError(2,2)
    errs["P3 LM VR obs"] = h_LM_VR_23.GetBinError(2,1)
    errs["P4 LM VR STC"] = h_LM_VR_23.GetBinError(3,3)
    errs["P4 LM VR pre"] = h_LM_VR_23.GetBinError(3,2)
    errs["P4 LM VR obs"] = h_LM_VR_23.GetBinError(3,1)
    errs["M LM VR STC"] = h_LM_VR_23.GetBinError(4,3)
    errs["M LM VR pre"] = h_LM_VR_23.GetBinError(4,2)
    errs["M LM VR obs"] = h_LM_VR_23.GetBinError(4,1)
    errs["L LM VR STC"] = h_LM_VR_23.GetBinError(5,3)
    errs["L LM VR pre"] = h_LM_VR_23.GetBinError(5,2)
    errs["L LM VR obs"] = h_LM_VR_23.GetBinError(5,1)

    errs["P LH VR STC"] = h_LH_VR_23.GetBinError(1,3)
    errs["P LH VR pre"] = h_LH_VR_23.GetBinError(1,2)
    errs["P LH VR obs"] = h_LH_VR_23.GetBinError(1,1)
    errs["P3 LH VR STC"] = h_LH_VR_23.GetBinError(2,3)
    errs["P3 LH VR pre"] = h_LH_VR_23.GetBinError(2,2)
    errs["P3 LH VR obs"] = h_LH_VR_23.GetBinError(2,1)
    errs["P4 LH VR STC"] = h_LH_VR_23.GetBinError(3,3)
    errs["P4 LH VR pre"] = h_LH_VR_23.GetBinError(3,2)
    errs["P4 LH VR obs"] = h_LH_VR_23.GetBinError(3,1)
    errs["M LH VR STC"] = h_LH_VR_23.GetBinError(4,3)
    errs["M LH VR pre"] = h_LH_VR_23.GetBinError(4,2)
    errs["M LH VR obs"] = h_LH_VR_23.GetBinError(4,1)
    errs["L LH VR STC"] = h_LH_VR_23.GetBinError(5,3)
    errs["L LH VR pre"] = h_LH_VR_23.GetBinError(5,2)
    errs["L LH VR obs"] = h_LH_VR_23.GetBinError(5,1)

    errs["P HL VR STC"] = h_HL_VR_4.GetBinError(1,3)
    errs["P HL VR pre"] = h_HL_VR_4.GetBinError(1,2)
    errs["P HL VR obs"] = h_HL_VR_4.GetBinError(1,1)
    errs["P3 HL VR STC"] = h_HL_VR_4.GetBinError(2,3)
    errs["P3 HL VR pre"] = h_HL_VR_4.GetBinError(2,2)
    errs["P3 HL VR obs"] = h_HL_VR_4.GetBinError(2,1)
    errs["P4 HL VR STC"] = h_HL_VR_4.GetBinError(3,3)
    errs["P4 HL VR pre"] = h_HL_VR_4.GetBinError(3,2)
    errs["P4 HL VR obs"] = h_HL_VR_4.GetBinError(3,1)
    errs["M HL VR STC"] = h_HL_VR_4.GetBinError(4,3)
    errs["M HL VR pre"] = h_HL_VR_4.GetBinError(4,2)
    errs["M HL VR obs"] = h_HL_VR_4.GetBinError(4,1)
    errs["L HL VR STC"] = h_HL_VR_4.GetBinError(5,3)
    errs["L HL VR pre"] = h_HL_VR_4.GetBinError(5,2)
    errs["L HL VR obs"] = h_HL_VR_4.GetBinError(5,1)

    errs["P HLM VR STC"] = h_HLM_VR_4.GetBinError(1,3)
    errs["P HLM VR pre"] = h_HLM_VR_4.GetBinError(1,2)
    errs["P HLM VR obs"] = h_HLM_VR_4.GetBinError(1,1)
    errs["P3 HLM VR STC"] = h_HLM_VR_4.GetBinError(2,3)
    errs["P3 HLM VR pre"] = h_HLM_VR_4.GetBinError(2,2)
    errs["P3 HLM VR obs"] = h_HLM_VR_4.GetBinError(2,1)
    errs["P4 HLM VR STC"] = h_HLM_VR_4.GetBinError(3,3)
    errs["P4 HLM VR pre"] = h_HLM_VR_4.GetBinError(3,2)
    errs["P4 HLM VR obs"] = h_HLM_VR_4.GetBinError(3,1)
    errs["M HLM VR STC"] = h_HLM_VR_4.GetBinError(4,3)
    errs["M HLM VR pre"] = h_HLM_VR_4.GetBinError(4,2)
    errs["M HLM VR obs"] = h_HLM_VR_4.GetBinError(4,1)
    errs["L HLM VR STC"] = h_HLM_VR_4.GetBinError(5,3)
    errs["L HLM VR pre"] = h_HLM_VR_4.GetBinError(5,2)
    errs["L HLM VR obs"] = h_HLM_VR_4.GetBinError(5,1)

    errs["P HM VR STC"] = h_HM_VR_4.GetBinError(1,3)
    errs["P HM VR pre"] = h_HM_VR_4.GetBinError(1,2)
    errs["P HM VR obs"] = h_HM_VR_4.GetBinError(1,1)
    errs["P3 HM VR STC"] = h_HM_VR_4.GetBinError(2,3)
    errs["P3 HM VR pre"] = h_HM_VR_4.GetBinError(2,2)
    errs["P3 HM VR obs"] = h_HM_VR_4.GetBinError(2,1)
    errs["P4 HM VR STC"] = h_HM_VR_4.GetBinError(3,3)
    errs["P4 HM VR pre"] = h_HM_VR_4.GetBinError(3,2)
    errs["P4 HM VR obs"] = h_HM_VR_4.GetBinError(3,1)
    errs["M HM VR STC"] = h_HM_VR_4.GetBinError(4,3)
    errs["M HM VR pre"] = h_HM_VR_4.GetBinError(4,2)
    errs["M HM VR obs"] = h_HM_VR_4.GetBinError(4,1)
    errs["L HM VR STC"] = h_HM_VR_4.GetBinError(5,3)
    errs["L HM VR pre"] = h_HM_VR_4.GetBinError(5,2)
    errs["L HM VR obs"] = h_HM_VR_4.GetBinError(5,1)

    errs["P HH VR STC"] = h_HH_VR_4.GetBinError(1,3)
    errs["P HH VR pre"] = h_HH_VR_4.GetBinError(1,2)
    errs["P HH VR obs"] = h_HH_VR_4.GetBinError(1,1)
    errs["P3 HH VR STC"] = h_HH_VR_4.GetBinError(2,3)
    errs["P3 HH VR pre"] = h_HH_VR_4.GetBinError(2,2)
    errs["P3 HH VR obs"] = h_HH_VR_4.GetBinError(2,1)
    errs["P4 HH VR STC"] = h_HH_VR_4.GetBinError(3,3)
    errs["P4 HH VR pre"] = h_HH_VR_4.GetBinError(3,2)
    errs["P4 HH VR obs"] = h_HH_VR_4.GetBinError(3,1)
    errs["M HH VR STC"] = h_HH_VR_4.GetBinError(4,3)
    errs["M HH VR pre"] = h_HH_VR_4.GetBinError(4,2)
    errs["M HH VR obs"] = h_HH_VR_4.GetBinError(4,1)
    errs["L HH VR STC"] = h_HH_VR_4.GetBinError(5,3)
    errs["L HH VR pre"] = h_HH_VR_4.GetBinError(5,2)
    errs["L HH VR obs"] = h_HH_VR_4.GetBinError(5,1)

    # hi pt
    errs["P LL VR hi STC"] = h_LL_VR_23_hi.GetBinError(1,3)
    errs["P LL VR hi pre"] = h_LL_VR_23_hi.GetBinError(1,2)
    errs["P LL VR hi obs"] = h_LL_VR_23_hi.GetBinError(1,1)
    errs["P3 LL VR hi STC"] = h_LL_VR_23_hi.GetBinError(2,3)
    errs["P3 LL VR hi pre"] = h_LL_VR_23_hi.GetBinError(2,2)
    errs["P3 LL VR hi obs"] = h_LL_VR_23_hi.GetBinError(2,1)
    errs["P4 LL VR hi STC"] = h_LL_VR_23_hi.GetBinError(3,3)
    errs["P4 LL VR hi pre"] = h_LL_VR_23_hi.GetBinError(3,2)
    errs["P4 LL VR hi obs"] = h_LL_VR_23_hi.GetBinError(3,1)
    errs["M LL VR hi STC"] = h_LL_VR_23_hi.GetBinError(4,3)
    errs["M LL VR hi pre"] = h_LL_VR_23_hi.GetBinError(4,2)
    errs["M LL VR hi obs"] = h_LL_VR_23_hi.GetBinError(4,1)
    errs["L LL VR hi STC"] = h_LL_VR_23_hi.GetBinError(5,3)
    errs["L LL VR hi pre"] = h_LL_VR_23_hi.GetBinError(5,2)
    errs["L LL VR hi obs"] = h_LL_VR_23_hi.GetBinError(5,1)

    errs["P LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinError(1,3)
    errs["P LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinError(1,2)
    errs["P LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinError(1,1)
    errs["P3 LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinError(2,3)
    errs["P3 LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinError(2,2)
    errs["P3 LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinError(2,1)
    errs["P4 LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinError(3,3)
    errs["P4 LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinError(3,2)
    errs["P4 LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinError(3,1)
    errs["M LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinError(4,3)
    errs["M LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinError(4,2)
    errs["M LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinError(4,1)
    errs["L LLM VR hi STC"] = h_LLM_VR_23_hi.GetBinError(5,3)
    errs["L LLM VR hi pre"] = h_LLM_VR_23_hi.GetBinError(5,2)
    errs["L LLM VR hi obs"] = h_LLM_VR_23_hi.GetBinError(5,1)

    errs["P LM VR hi STC"] = h_LM_VR_23_hi.GetBinError(1,3)
    errs["P LM VR hi pre"] = h_LM_VR_23_hi.GetBinError(1,2)
    errs["P LM VR hi obs"] = h_LM_VR_23_hi.GetBinError(1,1)
    errs["P3 LM VR hi STC"] = h_LM_VR_23_hi.GetBinError(2,3)
    errs["P3 LM VR hi pre"] = h_LM_VR_23_hi.GetBinError(2,2)
    errs["P3 LM VR hi obs"] = h_LM_VR_23_hi.GetBinError(2,1)
    errs["P4 LM VR hi STC"] = h_LM_VR_23_hi.GetBinError(3,3)
    errs["P4 LM VR hi pre"] = h_LM_VR_23_hi.GetBinError(3,2)
    errs["P4 LM VR hi obs"] = h_LM_VR_23_hi.GetBinError(3,1)
    errs["M LM VR hi STC"] = h_LM_VR_23_hi.GetBinError(4,3)
    errs["M LM VR hi pre"] = h_LM_VR_23_hi.GetBinError(4,2)
    errs["M LM VR hi obs"] = h_LM_VR_23_hi.GetBinError(4,1)
    errs["L LM VR hi STC"] = h_LM_VR_23_hi.GetBinError(5,3)
    errs["L LM VR hi pre"] = h_LM_VR_23_hi.GetBinError(5,2)
    errs["L LM VR hi obs"] = h_LM_VR_23_hi.GetBinError(5,1)

    errs["P LH VR hi STC"] = h_LH_VR_23_hi.GetBinError(1,3)
    errs["P LH VR hi pre"] = h_LH_VR_23_hi.GetBinError(1,2)
    errs["P LH VR hi obs"] = h_LH_VR_23_hi.GetBinError(1,1)
    errs["P3 LH VR hi STC"] = h_LH_VR_23_hi.GetBinError(2,3)
    errs["P3 LH VR hi pre"] = h_LH_VR_23_hi.GetBinError(2,2)
    errs["P3 LH VR hi obs"] = h_LH_VR_23_hi.GetBinError(2,1)
    errs["P4 LH VR hi STC"] = h_LH_VR_23_hi.GetBinError(3,3)
    errs["P4 LH VR hi pre"] = h_LH_VR_23_hi.GetBinError(3,2)
    errs["P4 LH VR hi obs"] = h_LH_VR_23_hi.GetBinError(3,1)
    errs["M LH VR hi STC"] = h_LH_VR_23_hi.GetBinError(4,3)
    errs["M LH VR hi pre"] = h_LH_VR_23_hi.GetBinError(4,2)
    errs["M LH VR hi obs"] = h_LH_VR_23_hi.GetBinError(4,1)
    errs["L LH VR hi STC"] = h_LH_VR_23_hi.GetBinError(5,3)
    errs["L LH VR hi pre"] = h_LH_VR_23_hi.GetBinError(5,2)
    errs["L LH VR hi obs"] = h_LH_VR_23_hi.GetBinError(5,1)

    errs["P HL VR hi STC"] = h_HL_VR_4_hi.GetBinError(1,3)
    errs["P HL VR hi pre"] = h_HL_VR_4_hi.GetBinError(1,2)
    errs["P HL VR hi obs"] = h_HL_VR_4_hi.GetBinError(1,1)
    errs["P3 HL VR hi STC"] = h_HL_VR_4_hi.GetBinError(2,3)
    errs["P3 HL VR hi pre"] = h_HL_VR_4_hi.GetBinError(2,2)
    errs["P3 HL VR hi obs"] = h_HL_VR_4_hi.GetBinError(2,1)
    errs["P4 HL VR hi STC"] = h_HL_VR_4_hi.GetBinError(3,3)
    errs["P4 HL VR hi pre"] = h_HL_VR_4_hi.GetBinError(3,2)
    errs["P4 HL VR hi obs"] = h_HL_VR_4_hi.GetBinError(3,1)
    errs["M HL VR hi STC"] = h_HL_VR_4_hi.GetBinError(4,3)
    errs["M HL VR hi pre"] = h_HL_VR_4_hi.GetBinError(4,2)
    errs["M HL VR hi obs"] = h_HL_VR_4_hi.GetBinError(4,1)
    errs["L HL VR hi STC"] = h_HL_VR_4_hi.GetBinError(5,3)
    errs["L HL VR hi pre"] = h_HL_VR_4_hi.GetBinError(5,2)
    errs["L HL VR hi obs"] = h_HL_VR_4_hi.GetBinError(5,1)

    errs["P HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinError(1,3)
    errs["P HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinError(1,2)
    errs["P HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinError(1,1)
    errs["P3 HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinError(2,3)
    errs["P3 HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinError(2,2)
    errs["P3 HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinError(2,1)
    errs["P4 HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinError(3,3)
    errs["P4 HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinError(3,2)
    errs["P4 HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinError(3,1)
    errs["M HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinError(4,3)
    errs["M HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinError(4,2)
    errs["M HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinError(4,1)
    errs["L HLM VR hi STC"] = h_HLM_VR_4_hi.GetBinError(5,3)
    errs["L HLM VR hi pre"] = h_HLM_VR_4_hi.GetBinError(5,2)
    errs["L HLM VR hi obs"] = h_HLM_VR_4_hi.GetBinError(5,1)

    errs["P HM VR hi STC"] = h_HM_VR_4_hi.GetBinError(1,3)
    errs["P HM VR hi pre"] = h_HM_VR_4_hi.GetBinError(1,2)
    errs["P HM VR hi obs"] = h_HM_VR_4_hi.GetBinError(1,1)
    errs["P3 HM VR hi STC"] = h_HM_VR_4_hi.GetBinError(2,3)
    errs["P3 HM VR hi pre"] = h_HM_VR_4_hi.GetBinError(2,2)
    errs["P3 HM VR hi obs"] = h_HM_VR_4_hi.GetBinError(2,1)
    errs["P4 HM VR hi STC"] = h_HM_VR_4_hi.GetBinError(3,3)
    errs["P4 HM VR hi pre"] = h_HM_VR_4_hi.GetBinError(3,2)
    errs["P4 HM VR hi obs"] = h_HM_VR_4_hi.GetBinError(3,1)
    errs["M HM VR hi STC"] = h_HM_VR_4_hi.GetBinError(4,3)
    errs["M HM VR hi pre"] = h_HM_VR_4_hi.GetBinError(4,2)
    errs["M HM VR hi obs"] = h_HM_VR_4_hi.GetBinError(4,1)
    errs["L HM VR hi STC"] = h_HM_VR_4_hi.GetBinError(5,3)
    errs["L HM VR hi pre"] = h_HM_VR_4_hi.GetBinError(5,2)
    errs["L HM VR hi obs"] = h_HM_VR_4_hi.GetBinError(5,1)

    errs["P HH VR hi STC"] = h_HH_VR_4_hi.GetBinError(1,3)
    errs["P HH VR hi pre"] = h_HH_VR_4_hi.GetBinError(1,2)
    errs["P HH VR hi obs"] = h_HH_VR_4_hi.GetBinError(1,1)
    errs["P3 HH VR hi STC"] = h_HH_VR_4_hi.GetBinError(2,3)
    errs["P3 HH VR hi pre"] = h_HH_VR_4_hi.GetBinError(2,2)
    errs["P3 HH VR hi obs"] = h_HH_VR_4_hi.GetBinError(2,1)
    errs["P4 HH VR hi STC"] = h_HH_VR_4_hi.GetBinError(3,3)
    errs["P4 HH VR hi pre"] = h_HH_VR_4_hi.GetBinError(3,2)
    errs["P4 HH VR hi obs"] = h_HH_VR_4_hi.GetBinError(3,1)
    errs["M HH VR hi STC"] = h_HH_VR_4_hi.GetBinError(4,3)
    errs["M HH VR hi pre"] = h_HH_VR_4_hi.GetBinError(4,2)
    errs["M HH VR hi obs"] = h_HH_VR_4_hi.GetBinError(4,1)
    errs["L HH VR hi STC"] = h_HH_VR_4_hi.GetBinError(5,3)
    errs["L HH VR hi pre"] = h_HH_VR_4_hi.GetBinError(5,2)
    errs["L HH VR hi obs"] = h_HH_VR_4_hi.GetBinError(5,1)

    # lo pt
    errs["P LL VR lo STC"] = h_LL_VR_23_lo.GetBinError(1,3)
    errs["P LL VR lo pre"] = h_LL_VR_23_lo.GetBinError(1,2)
    errs["P LL VR lo obs"] = h_LL_VR_23_lo.GetBinError(1,1)
    errs["P3 LL VR lo STC"] = h_LL_VR_23_lo.GetBinError(2,3)
    errs["P3 LL VR lo pre"] = h_LL_VR_23_lo.GetBinError(2,2)
    errs["P3 LL VR lo obs"] = h_LL_VR_23_lo.GetBinError(2,1)
    errs["P4 LL VR lo STC"] = h_LL_VR_23_lo.GetBinError(3,3)
    errs["P4 LL VR lo pre"] = h_LL_VR_23_lo.GetBinError(3,2)
    errs["P4 LL VR lo obs"] = h_LL_VR_23_lo.GetBinError(3,1)
    errs["M LL VR lo STC"] = h_LL_VR_23_lo.GetBinError(4,3)
    errs["M LL VR lo pre"] = h_LL_VR_23_lo.GetBinError(4,2)
    errs["M LL VR lo obs"] = h_LL_VR_23_lo.GetBinError(4,1)
    errs["L LL VR lo STC"] = h_LL_VR_23_lo.GetBinError(5,3)
    errs["L LL VR lo pre"] = h_LL_VR_23_lo.GetBinError(5,2)
    errs["L LL VR lo obs"] = h_LL_VR_23_lo.GetBinError(5,1)

    errs["P LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinError(1,3)
    errs["P LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinError(1,2)
    errs["P LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinError(1,1)
    errs["P3 LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinError(2,3)
    errs["P3 LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinError(2,2)
    errs["P3 LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinError(2,1)
    errs["P4 LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinError(3,3)
    errs["P4 LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinError(3,2)
    errs["P4 LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinError(3,1)
    errs["M LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinError(4,3)
    errs["M LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinError(4,2)
    errs["M LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinError(4,1)
    errs["L LLM VR lo STC"] = h_LLM_VR_23_lo.GetBinError(5,3)
    errs["L LLM VR lo pre"] = h_LLM_VR_23_lo.GetBinError(5,2)
    errs["L LLM VR lo obs"] = h_LLM_VR_23_lo.GetBinError(5,1)

    errs["P LM VR lo STC"] = h_LM_VR_23_lo.GetBinError(1,3)
    errs["P LM VR lo pre"] = h_LM_VR_23_lo.GetBinError(1,2)
    errs["P LM VR lo obs"] = h_LM_VR_23_lo.GetBinError(1,1)
    errs["P3 LM VR lo STC"] = h_LM_VR_23_lo.GetBinError(2,3)
    errs["P3 LM VR lo pre"] = h_LM_VR_23_lo.GetBinError(2,2)
    errs["P3 LM VR lo obs"] = h_LM_VR_23_lo.GetBinError(2,1)
    errs["P4 LM VR lo STC"] = h_LM_VR_23_lo.GetBinError(3,3)
    errs["P4 LM VR lo pre"] = h_LM_VR_23_lo.GetBinError(3,2)
    errs["P4 LM VR lo obs"] = h_LM_VR_23_lo.GetBinError(3,1)
    errs["M LM VR lo STC"] = h_LM_VR_23_lo.GetBinError(4,3)
    errs["M LM VR lo pre"] = h_LM_VR_23_lo.GetBinError(4,2)
    errs["M LM VR lo obs"] = h_LM_VR_23_lo.GetBinError(4,1)
    errs["L LM VR lo STC"] = h_LM_VR_23_lo.GetBinError(5,3)
    errs["L LM VR lo pre"] = h_LM_VR_23_lo.GetBinError(5,2)
    errs["L LM VR lo obs"] = h_LM_VR_23_lo.GetBinError(5,1)

    errs["P LH VR lo STC"] = h_LH_VR_23_lo.GetBinError(1,3)
    errs["P LH VR lo pre"] = h_LH_VR_23_lo.GetBinError(1,2)
    errs["P LH VR lo obs"] = h_LH_VR_23_lo.GetBinError(1,1)
    errs["P3 LH VR lo STC"] = h_LH_VR_23_lo.GetBinError(2,3)
    errs["P3 LH VR lo pre"] = h_LH_VR_23_lo.GetBinError(2,2)
    errs["P3 LH VR lo obs"] = h_LH_VR_23_lo.GetBinError(2,1)
    errs["P4 LH VR lo STC"] = h_LH_VR_23_lo.GetBinError(3,3)
    errs["P4 LH VR lo pre"] = h_LH_VR_23_lo.GetBinError(3,2)
    errs["P4 LH VR lo obs"] = h_LH_VR_23_lo.GetBinError(3,1)
    errs["M LH VR lo STC"] = h_LH_VR_23_lo.GetBinError(4,3)
    errs["M LH VR lo pre"] = h_LH_VR_23_lo.GetBinError(4,2)
    errs["M LH VR lo obs"] = h_LH_VR_23_lo.GetBinError(4,1)
    errs["L LH VR lo STC"] = h_LH_VR_23_lo.GetBinError(5,3)
    errs["L LH VR lo pre"] = h_LH_VR_23_lo.GetBinError(5,2)
    errs["L LH VR lo obs"] = h_LH_VR_23_lo.GetBinError(5,1)

    errs["P HL VR lo STC"] = h_HL_VR_4_lo.GetBinError(1,3)
    errs["P HL VR lo pre"] = h_HL_VR_4_lo.GetBinError(1,2)
    errs["P HL VR lo obs"] = h_HL_VR_4_lo.GetBinError(1,1)
    errs["P3 HL VR lo STC"] = h_HL_VR_4_lo.GetBinError(2,3)
    errs["P3 HL VR lo pre"] = h_HL_VR_4_lo.GetBinError(2,2)
    errs["P3 HL VR lo obs"] = h_HL_VR_4_lo.GetBinError(2,1)
    errs["P4 HL VR lo STC"] = h_HL_VR_4_lo.GetBinError(3,3)
    errs["P4 HL VR lo pre"] = h_HL_VR_4_lo.GetBinError(3,2)
    errs["P4 HL VR lo obs"] = h_HL_VR_4_lo.GetBinError(3,1)
    errs["M HL VR lo STC"] = h_HL_VR_4_lo.GetBinError(4,3)
    errs["M HL VR lo pre"] = h_HL_VR_4_lo.GetBinError(4,2)
    errs["M HL VR lo obs"] = h_HL_VR_4_lo.GetBinError(4,1)
    errs["L HL VR lo STC"] = h_HL_VR_4_lo.GetBinError(5,3)
    errs["L HL VR lo pre"] = h_HL_VR_4_lo.GetBinError(5,2)
    errs["L HL VR lo obs"] = h_HL_VR_4_lo.GetBinError(5,1)

    errs["P HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinError(1,3)
    errs["P HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinError(1,2)
    errs["P HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinError(1,1)
    errs["P3 HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinError(2,3)
    errs["P3 HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinError(2,2)
    errs["P3 HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinError(2,1)
    errs["P4 HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinError(3,3)
    errs["P4 HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinError(3,2)
    errs["P4 HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinError(3,1)
    errs["M HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinError(4,3)
    errs["M HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinError(4,2)
    errs["M HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinError(4,1)
    errs["L HLM VR lo STC"] = h_HLM_VR_4_lo.GetBinError(5,3)
    errs["L HLM VR lo pre"] = h_HLM_VR_4_lo.GetBinError(5,2)
    errs["L HLM VR lo obs"] = h_HLM_VR_4_lo.GetBinError(5,1)

    errs["P HM VR lo STC"] = h_HM_VR_4_lo.GetBinError(1,3)
    errs["P HM VR lo pre"] = h_HM_VR_4_lo.GetBinError(1,2)
    errs["P HM VR lo obs"] = h_HM_VR_4_lo.GetBinError(1,1)
    errs["P3 HM VR lo STC"] = h_HM_VR_4_lo.GetBinError(2,3)
    errs["P3 HM VR lo pre"] = h_HM_VR_4_lo.GetBinError(2,2)
    errs["P3 HM VR lo obs"] = h_HM_VR_4_lo.GetBinError(2,1)
    errs["P4 HM VR lo STC"] = h_HM_VR_4_lo.GetBinError(3,3)
    errs["P4 HM VR lo pre"] = h_HM_VR_4_lo.GetBinError(3,2)
    errs["P4 HM VR lo obs"] = h_HM_VR_4_lo.GetBinError(3,1)
    errs["M HM VR lo STC"] = h_HM_VR_4_lo.GetBinError(4,3)
    errs["M HM VR lo pre"] = h_HM_VR_4_lo.GetBinError(4,2)
    errs["M HM VR lo obs"] = h_HM_VR_4_lo.GetBinError(4,1)
    errs["L HM VR lo STC"] = h_HM_VR_4_lo.GetBinError(5,3)
    errs["L HM VR lo pre"] = h_HM_VR_4_lo.GetBinError(5,2)
    errs["L HM VR lo obs"] = h_HM_VR_4_lo.GetBinError(5,1)

    errs["P HH VR lo STC"] = h_HH_VR_4_lo.GetBinError(1,3)
    errs["P HH VR lo pre"] = h_HH_VR_4_lo.GetBinError(1,2)
    errs["P HH VR lo obs"] = h_HH_VR_4_lo.GetBinError(1,1)
    errs["P3 HH VR lo STC"] = h_HH_VR_4_lo.GetBinError(2,3)
    errs["P3 HH VR lo pre"] = h_HH_VR_4_lo.GetBinError(2,2)
    errs["P3 HH VR lo obs"] = h_HH_VR_4_lo.GetBinError(2,1)
    errs["P4 HH VR lo STC"] = h_HH_VR_4_lo.GetBinError(3,3)
    errs["P4 HH VR lo pre"] = h_HH_VR_4_lo.GetBinError(3,2)
    errs["P4 HH VR lo obs"] = h_HH_VR_4_lo.GetBinError(3,1)
    errs["M HH VR lo STC"] = h_HH_VR_4_lo.GetBinError(4,3)
    errs["M HH VR lo pre"] = h_HH_VR_4_lo.GetBinError(4,2)
    errs["M HH VR lo obs"] = h_HH_VR_4_lo.GetBinError(4,1)
    errs["L HH VR lo STC"] = h_HH_VR_4_lo.GetBinError(5,3)
    errs["L HH VR lo pre"] = h_HH_VR_4_lo.GetBinError(5,2)
    errs["L HH VR lo obs"] = h_HH_VR_4_lo.GetBinError(5,1)

    # SR vals
    vals["P LL SR STC"] = h_LL_SR_23.GetBinContent(1,3)
    vals["P LL SR pre"] = h_LL_SR_23.GetBinContent(1,2)
    vals["P LL SR obs"] = h_LL_SR_23.GetBinContent(1,1)
    vals["P3 LL SR STC"] = h_LL_SR_23.GetBinContent(2,3)
    vals["P3 LL SR pre"] = h_LL_SR_23.GetBinContent(2,2)
    vals["P3 LL SR obs"] = h_LL_SR_23.GetBinContent(2,1)
    vals["P4 LL SR STC"] = h_LL_SR_23.GetBinContent(3,3)
    vals["P4 LL SR pre"] = h_LL_SR_23.GetBinContent(3,2)
    vals["P4 LL SR obs"] = h_LL_SR_23.GetBinContent(3,1)
    vals["M LL SR STC"] = h_LL_SR_23.GetBinContent(4,3)
    vals["M LL SR pre"] = h_LL_SR_23.GetBinContent(4,2)
    vals["M LL SR obs"] = h_LL_SR_23.GetBinContent(4,1)
    vals["L LL SR STC"] = h_LL_SR_23.GetBinContent(5,3)
    vals["L LL SR pre"] = h_LL_SR_23.GetBinContent(5,2)
    vals["L LL SR obs"] = h_LL_SR_23.GetBinContent(5,1)

    vals["P LLM SR STC"] = h_LLM_SR_23.GetBinContent(1,3)
    vals["P LLM SR pre"] = h_LLM_SR_23.GetBinContent(1,2)
    vals["P LLM SR obs"] = h_LLM_SR_23.GetBinContent(1,1)
    vals["P3 LLM SR STC"] = h_LLM_SR_23.GetBinContent(2,3)
    vals["P3 LLM SR pre"] = h_LLM_SR_23.GetBinContent(2,2)
    vals["P3 LLM SR obs"] = h_LLM_SR_23.GetBinContent(2,1)
    vals["P4 LLM SR STC"] = h_LLM_SR_23.GetBinContent(3,3)
    vals["P4 LLM SR pre"] = h_LLM_SR_23.GetBinContent(3,2)
    vals["P4 LLM SR obs"] = h_LLM_SR_23.GetBinContent(3,1)
    vals["M LLM SR STC"] = h_LLM_SR_23.GetBinContent(4,3)
    vals["M LLM SR pre"] = h_LLM_SR_23.GetBinContent(4,2)
    vals["M LLM SR obs"] = h_LLM_SR_23.GetBinContent(4,1)
    vals["L LLM SR STC"] = h_LLM_SR_23.GetBinContent(5,3)
    vals["L LLM SR pre"] = h_LLM_SR_23.GetBinContent(5,2)
    vals["L LLM SR obs"] = h_LLM_SR_23.GetBinContent(5,1)

    vals["P LM SR STC"] = h_LM_SR_23.GetBinContent(1,3)
    vals["P LM SR pre"] = h_LM_SR_23.GetBinContent(1,2)
    vals["P LM SR obs"] = h_LM_SR_23.GetBinContent(1,1)
    vals["P3 LM SR STC"] = h_LM_SR_23.GetBinContent(2,3)
    vals["P3 LM SR pre"] = h_LM_SR_23.GetBinContent(2,2)
    vals["P3 LM SR obs"] = h_LM_SR_23.GetBinContent(2,1)
    vals["P4 LM SR STC"] = h_LM_SR_23.GetBinContent(3,3)
    vals["P4 LM SR pre"] = h_LM_SR_23.GetBinContent(3,2)
    vals["P4 LM SR obs"] = h_LM_SR_23.GetBinContent(3,1)
    vals["M LM SR STC"] = h_LM_SR_23.GetBinContent(4,3)
    vals["M LM SR pre"] = h_LM_SR_23.GetBinContent(4,2)
    vals["M LM SR obs"] = h_LM_SR_23.GetBinContent(4,1)
    vals["L LM SR STC"] = h_LM_SR_23.GetBinContent(5,3)
    vals["L LM SR pre"] = h_LM_SR_23.GetBinContent(5,2)
    vals["L LM SR obs"] = h_LM_SR_23.GetBinContent(5,1)

    vals["P LH SR STC"] = h_LH_SR_23.GetBinContent(1,3)
    vals["P LH SR pre"] = h_LH_SR_23.GetBinContent(1,2)
    vals["P LH SR obs"] = h_LH_SR_23.GetBinContent(1,1)
    vals["P3 LH SR STC"] = h_LH_SR_23.GetBinContent(2,3)
    vals["P3 LH SR pre"] = h_LH_SR_23.GetBinContent(2,2)
    vals["P3 LH SR obs"] = h_LH_SR_23.GetBinContent(2,1)
    vals["P4 LH SR STC"] = h_LH_SR_23.GetBinContent(3,3)
    vals["P4 LH SR pre"] = h_LH_SR_23.GetBinContent(3,2)
    vals["P4 LH SR obs"] = h_LH_SR_23.GetBinContent(3,1)
    vals["M LH SR STC"] = h_LH_SR_23.GetBinContent(4,3)
    vals["M LH SR pre"] = h_LH_SR_23.GetBinContent(4,2)
    vals["M LH SR obs"] = h_LH_SR_23.GetBinContent(4,1)
    vals["L LH SR STC"] = h_LH_SR_23.GetBinContent(5,3)
    vals["L LH SR pre"] = h_LH_SR_23.GetBinContent(5,2)
    vals["L LH SR obs"] = h_LH_SR_23.GetBinContent(5,1)

    vals["P HL SR STC"] = h_HL_SR_4.GetBinContent(1,3)
    vals["P HL SR pre"] = h_HL_SR_4.GetBinContent(1,2)
    vals["P HL SR obs"] = h_HL_SR_4.GetBinContent(1,1)
    vals["P3 HL SR STC"] = h_HL_SR_4.GetBinContent(2,3)
    vals["P3 HL SR pre"] = h_HL_SR_4.GetBinContent(2,2)
    vals["P3 HL SR obs"] = h_HL_SR_4.GetBinContent(2,1)
    vals["P4 HL SR STC"] = h_HL_SR_4.GetBinContent(3,3)
    vals["P4 HL SR pre"] = h_HL_SR_4.GetBinContent(3,2)
    vals["P4 HL SR obs"] = h_HL_SR_4.GetBinContent(3,1)
    vals["M HL SR STC"] = h_HL_SR_4.GetBinContent(4,3)
    vals["M HL SR pre"] = h_HL_SR_4.GetBinContent(4,2)
    vals["M HL SR obs"] = h_HL_SR_4.GetBinContent(4,1)
    vals["L HL SR STC"] = h_HL_SR_4.GetBinContent(5,3)
    vals["L HL SR pre"] = h_HL_SR_4.GetBinContent(5,2)
    vals["L HL SR obs"] = h_HL_SR_4.GetBinContent(5,1)

    vals["P HLM SR STC"] = h_HLM_SR_4.GetBinContent(1,3)
    vals["P HLM SR pre"] = h_HLM_SR_4.GetBinContent(1,2)
    vals["P HLM SR obs"] = h_HLM_SR_4.GetBinContent(1,1)
    vals["P3 HLM SR STC"] = h_HLM_SR_4.GetBinContent(2,3)
    vals["P3 HLM SR pre"] = h_HLM_SR_4.GetBinContent(2,2)
    vals["P3 HLM SR obs"] = h_HLM_SR_4.GetBinContent(2,1)
    vals["P4 HLM SR STC"] = h_HLM_SR_4.GetBinContent(3,3)
    vals["P4 HLM SR pre"] = h_HLM_SR_4.GetBinContent(3,2)
    vals["P4 HLM SR obs"] = h_HLM_SR_4.GetBinContent(3,1)
    vals["M HLM SR STC"] = h_HLM_SR_4.GetBinContent(4,3)
    vals["M HLM SR pre"] = h_HLM_SR_4.GetBinContent(4,2)
    vals["M HLM SR obs"] = h_HLM_SR_4.GetBinContent(4,1)
    vals["L HLM SR STC"] = h_HLM_SR_4.GetBinContent(5,3)
    vals["L HLM SR pre"] = h_HLM_SR_4.GetBinContent(5,2)
    vals["L HLM SR obs"] = h_HLM_SR_4.GetBinContent(5,1)

    vals["P HM SR STC"] = h_HM_SR_4.GetBinContent(1,3)
    vals["P HM SR pre"] = h_HM_SR_4.GetBinContent(1,2)
    vals["P HM SR obs"] = h_HM_SR_4.GetBinContent(1,1)
    vals["P3 HM SR STC"] = h_HM_SR_4.GetBinContent(2,3)
    vals["P3 HM SR pre"] = h_HM_SR_4.GetBinContent(2,2)
    vals["P3 HM SR obs"] = h_HM_SR_4.GetBinContent(2,1)
    vals["P4 HM SR STC"] = h_HM_SR_4.GetBinContent(3,3)
    vals["P4 HM SR pre"] = h_HM_SR_4.GetBinContent(3,2)
    vals["P4 HM SR obs"] = h_HM_SR_4.GetBinContent(3,1)
    vals["M HM SR STC"] = h_HM_SR_4.GetBinContent(4,3)
    vals["M HM SR pre"] = h_HM_SR_4.GetBinContent(4,2)
    vals["M HM SR obs"] = h_HM_SR_4.GetBinContent(4,1)
    vals["L HM SR STC"] = h_HM_SR_4.GetBinContent(5,3)
    vals["L HM SR pre"] = h_HM_SR_4.GetBinContent(5,2)
    vals["L HM SR obs"] = h_HM_SR_4.GetBinContent(5,1)

    vals["P HH SR STC"] = h_HH_SR_4.GetBinContent(1,3)
    vals["P HH SR pre"] = h_HH_SR_4.GetBinContent(1,2)
    vals["P HH SR obs"] = h_HH_SR_4.GetBinContent(1,1)
    vals["P3 HH SR STC"] = h_HH_SR_4.GetBinContent(2,3)
    vals["P3 HH SR pre"] = h_HH_SR_4.GetBinContent(2,2)
    vals["P3 HH SR obs"] = h_HH_SR_4.GetBinContent(2,1)
    vals["P4 HH SR STC"] = h_HH_SR_4.GetBinContent(3,3)
    vals["P4 HH SR pre"] = h_HH_SR_4.GetBinContent(3,2)
    vals["P4 HH SR obs"] = h_HH_SR_4.GetBinContent(3,1)
    vals["M HH SR STC"] = h_HH_SR_4.GetBinContent(4,3)
    vals["M HH SR pre"] = h_HH_SR_4.GetBinContent(4,2)
    vals["M HH SR obs"] = h_HH_SR_4.GetBinContent(4,1)
    vals["L HH SR STC"] = h_HH_SR_4.GetBinContent(5,3)
    vals["L HH SR pre"] = h_HH_SR_4.GetBinContent(5,2)
    vals["L HH SR obs"] = h_HH_SR_4.GetBinContent(5,1)

    # hi pt
    vals["P LL SR hi STC"] = h_LL_SR_23_hi.GetBinContent(1,3)
    vals["P LL SR hi pre"] = h_LL_SR_23_hi.GetBinContent(1,2)
    vals["P LL SR hi obs"] = h_LL_SR_23_hi.GetBinContent(1,1)
    vals["P3 LL SR hi STC"] = h_LL_SR_23_hi.GetBinContent(2,3)
    vals["P3 LL SR hi pre"] = h_LL_SR_23_hi.GetBinContent(2,2)
    vals["P3 LL SR hi obs"] = h_LL_SR_23_hi.GetBinContent(2,1)
    vals["P4 LL SR hi STC"] = h_LL_SR_23_hi.GetBinContent(3,3)
    vals["P4 LL SR hi pre"] = h_LL_SR_23_hi.GetBinContent(3,2)
    vals["P4 LL SR hi obs"] = h_LL_SR_23_hi.GetBinContent(3,1)
    vals["M LL SR hi STC"] = h_LL_SR_23_hi.GetBinContent(4,3)
    vals["M LL SR hi pre"] = h_LL_SR_23_hi.GetBinContent(4,2)
    vals["M LL SR hi obs"] = h_LL_SR_23_hi.GetBinContent(4,1)
    vals["L LL SR hi STC"] = h_LL_SR_23_hi.GetBinContent(5,3)
    vals["L LL SR hi pre"] = h_LL_SR_23_hi.GetBinContent(5,2)
    vals["L LL SR hi obs"] = h_LL_SR_23_hi.GetBinContent(5,1)

    vals["P LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinContent(1,3)
    vals["P LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinContent(1,2)
    vals["P LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinContent(1,1)
    vals["P3 LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinContent(2,3)
    vals["P3 LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinContent(2,2)
    vals["P3 LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinContent(2,1)
    vals["P4 LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinContent(3,3)
    vals["P4 LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinContent(3,2)
    vals["P4 LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinContent(3,1)
    vals["M LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinContent(4,3)
    vals["M LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinContent(4,2)
    vals["M LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinContent(4,1)
    vals["L LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinContent(5,3)
    vals["L LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinContent(5,2)
    vals["L LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinContent(5,1)

    vals["P LM SR hi STC"] = h_LM_SR_23_hi.GetBinContent(1,3)
    vals["P LM SR hi pre"] = h_LM_SR_23_hi.GetBinContent(1,2)
    vals["P LM SR hi obs"] = h_LM_SR_23_hi.GetBinContent(1,1)
    vals["P3 LM SR hi STC"] = h_LM_SR_23_hi.GetBinContent(2,3)
    vals["P3 LM SR hi pre"] = h_LM_SR_23_hi.GetBinContent(2,2)
    vals["P3 LM SR hi obs"] = h_LM_SR_23_hi.GetBinContent(2,1)
    vals["P4 LM SR hi STC"] = h_LM_SR_23_hi.GetBinContent(3,3)
    vals["P4 LM SR hi pre"] = h_LM_SR_23_hi.GetBinContent(3,2)
    vals["P4 LM SR hi obs"] = h_LM_SR_23_hi.GetBinContent(3,1)
    vals["M LM SR hi STC"] = h_LM_SR_23_hi.GetBinContent(4,3)
    vals["M LM SR hi pre"] = h_LM_SR_23_hi.GetBinContent(4,2)
    vals["M LM SR hi obs"] = h_LM_SR_23_hi.GetBinContent(4,1)
    vals["L LM SR hi STC"] = h_LM_SR_23_hi.GetBinContent(5,3)
    vals["L LM SR hi pre"] = h_LM_SR_23_hi.GetBinContent(5,2)
    vals["L LM SR hi obs"] = h_LM_SR_23_hi.GetBinContent(5,1)

    vals["P LH SR hi STC"] = h_LH_SR_23_hi.GetBinContent(1,3)
    vals["P LH SR hi pre"] = h_LH_SR_23_hi.GetBinContent(1,2)
    vals["P LH SR hi obs"] = h_LH_SR_23_hi.GetBinContent(1,1)
    vals["P3 LH SR hi STC"] = h_LH_SR_23_hi.GetBinContent(2,3)
    vals["P3 LH SR hi pre"] = h_LH_SR_23_hi.GetBinContent(2,2)
    vals["P3 LH SR hi obs"] = h_LH_SR_23_hi.GetBinContent(2,1)
    vals["P4 LH SR hi STC"] = h_LH_SR_23_hi.GetBinContent(3,3)
    vals["P4 LH SR hi pre"] = h_LH_SR_23_hi.GetBinContent(3,2)
    vals["P4 LH SR hi obs"] = h_LH_SR_23_hi.GetBinContent(3,1)
    vals["M LH SR hi STC"] = h_LH_SR_23_hi.GetBinContent(4,3)
    vals["M LH SR hi pre"] = h_LH_SR_23_hi.GetBinContent(4,2)
    vals["M LH SR hi obs"] = h_LH_SR_23_hi.GetBinContent(4,1)
    vals["L LH SR hi STC"] = h_LH_SR_23_hi.GetBinContent(5,3)
    vals["L LH SR hi pre"] = h_LH_SR_23_hi.GetBinContent(5,2)
    vals["L LH SR hi obs"] = h_LH_SR_23_hi.GetBinContent(5,1)

    vals["P HL SR hi STC"] = h_HL_SR_4_hi.GetBinContent(1,3)
    vals["P HL SR hi pre"] = h_HL_SR_4_hi.GetBinContent(1,2)
    vals["P HL SR hi obs"] = h_HL_SR_4_hi.GetBinContent(1,1)
    vals["P3 HL SR hi STC"] = h_HL_SR_4_hi.GetBinContent(2,3)
    vals["P3 HL SR hi pre"] = h_HL_SR_4_hi.GetBinContent(2,2)
    vals["P3 HL SR hi obs"] = h_HL_SR_4_hi.GetBinContent(2,1)
    vals["P4 HL SR hi STC"] = h_HL_SR_4_hi.GetBinContent(3,3)
    vals["P4 HL SR hi pre"] = h_HL_SR_4_hi.GetBinContent(3,2)
    vals["P4 HL SR hi obs"] = h_HL_SR_4_hi.GetBinContent(3,1)
    vals["M HL SR hi STC"] = h_HL_SR_4_hi.GetBinContent(4,3)
    vals["M HL SR hi pre"] = h_HL_SR_4_hi.GetBinContent(4,2)
    vals["M HL SR hi obs"] = h_HL_SR_4_hi.GetBinContent(4,1)
    vals["L HL SR hi STC"] = h_HL_SR_4_hi.GetBinContent(5,3)
    vals["L HL SR hi pre"] = h_HL_SR_4_hi.GetBinContent(5,2)
    vals["L HL SR hi obs"] = h_HL_SR_4_hi.GetBinContent(5,1)

    vals["P HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinContent(1,3)
    vals["P HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinContent(1,2)
    vals["P HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinContent(1,1)
    vals["P3 HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinContent(2,3)
    vals["P3 HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinContent(2,2)
    vals["P3 HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinContent(2,1)
    vals["P4 HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinContent(3,3)
    vals["P4 HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinContent(3,2)
    vals["P4 HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinContent(3,1)
    vals["M HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinContent(4,3)
    vals["M HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinContent(4,2)
    vals["M HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinContent(4,1)
    vals["L HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinContent(5,3)
    vals["L HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinContent(5,2)
    vals["L HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinContent(5,1)

    vals["P HM SR hi STC"] = h_HM_SR_4_hi.GetBinContent(1,3)
    vals["P HM SR hi pre"] = h_HM_SR_4_hi.GetBinContent(1,2)
    vals["P HM SR hi obs"] = h_HM_SR_4_hi.GetBinContent(1,1)
    vals["P3 HM SR hi STC"] = h_HM_SR_4_hi.GetBinContent(2,3)
    vals["P3 HM SR hi pre"] = h_HM_SR_4_hi.GetBinContent(2,2)
    vals["P3 HM SR hi obs"] = h_HM_SR_4_hi.GetBinContent(2,1)
    vals["P4 HM SR hi STC"] = h_HM_SR_4_hi.GetBinContent(3,3)
    vals["P4 HM SR hi pre"] = h_HM_SR_4_hi.GetBinContent(3,2)
    vals["P4 HM SR hi obs"] = h_HM_SR_4_hi.GetBinContent(3,1)
    vals["M HM SR hi STC"] = h_HM_SR_4_hi.GetBinContent(4,3)
    vals["M HM SR hi pre"] = h_HM_SR_4_hi.GetBinContent(4,2)
    vals["M HM SR hi obs"] = h_HM_SR_4_hi.GetBinContent(4,1)
    vals["L HM SR hi STC"] = h_HM_SR_4_hi.GetBinContent(5,3)
    vals["L HM SR hi pre"] = h_HM_SR_4_hi.GetBinContent(5,2)
    vals["L HM SR hi obs"] = h_HM_SR_4_hi.GetBinContent(5,1)

    vals["P HH SR hi STC"] = h_HH_SR_4_hi.GetBinContent(1,3)
    vals["P HH SR hi pre"] = h_HH_SR_4_hi.GetBinContent(1,2)
    vals["P HH SR hi obs"] = h_HH_SR_4_hi.GetBinContent(1,1)
    vals["P3 HH SR hi STC"] = h_HH_SR_4_hi.GetBinContent(2,3)
    vals["P3 HH SR hi pre"] = h_HH_SR_4_hi.GetBinContent(2,2)
    vals["P3 HH SR hi obs"] = h_HH_SR_4_hi.GetBinContent(2,1)
    vals["P4 HH SR hi STC"] = h_HH_SR_4_hi.GetBinContent(3,3)
    vals["P4 HH SR hi pre"] = h_HH_SR_4_hi.GetBinContent(3,2)
    vals["P4 HH SR hi obs"] = h_HH_SR_4_hi.GetBinContent(3,1)
    vals["M HH SR hi STC"] = h_HH_SR_4_hi.GetBinContent(4,3)
    vals["M HH SR hi pre"] = h_HH_SR_4_hi.GetBinContent(4,2)
    vals["M HH SR hi obs"] = h_HH_SR_4_hi.GetBinContent(4,1)
    vals["L HH SR hi STC"] = h_HH_SR_4_hi.GetBinContent(5,3)
    vals["L HH SR hi pre"] = h_HH_SR_4_hi.GetBinContent(5,2)
    vals["L HH SR hi obs"] = h_HH_SR_4_hi.GetBinContent(5,1)

    # lo pt
    vals["P LL SR lo STC"] = h_LL_SR_23_lo.GetBinContent(1,3)
    vals["P LL SR lo pre"] = h_LL_SR_23_lo.GetBinContent(1,2)
    vals["P LL SR lo obs"] = h_LL_SR_23_lo.GetBinContent(1,1)
    vals["P3 LL SR lo STC"] = h_LL_SR_23_lo.GetBinContent(2,3)
    vals["P3 LL SR lo pre"] = h_LL_SR_23_lo.GetBinContent(2,2)
    vals["P3 LL SR lo obs"] = h_LL_SR_23_lo.GetBinContent(2,1)
    vals["P4 LL SR lo STC"] = h_LL_SR_23_lo.GetBinContent(3,3)
    vals["P4 LL SR lo pre"] = h_LL_SR_23_lo.GetBinContent(3,2)
    vals["P4 LL SR lo obs"] = h_LL_SR_23_lo.GetBinContent(3,1)
    vals["M LL SR lo STC"] = h_LL_SR_23_lo.GetBinContent(4,3)
    vals["M LL SR lo pre"] = h_LL_SR_23_lo.GetBinContent(4,2)
    vals["M LL SR lo obs"] = h_LL_SR_23_lo.GetBinContent(4,1)
    vals["L LL SR lo STC"] = h_LL_SR_23_lo.GetBinContent(5,3)
    vals["L LL SR lo pre"] = h_LL_SR_23_lo.GetBinContent(5,2)
    vals["L LL SR lo obs"] = h_LL_SR_23_lo.GetBinContent(5,1)

    vals["P LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinContent(1,3)
    vals["P LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinContent(1,2)
    vals["P LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinContent(1,1)
    vals["P3 LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinContent(2,3)
    vals["P3 LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinContent(2,2)
    vals["P3 LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinContent(2,1)
    vals["P4 LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinContent(3,3)
    vals["P4 LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinContent(3,2)
    vals["P4 LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinContent(3,1)
    vals["M LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinContent(4,3)
    vals["M LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinContent(4,2)
    vals["M LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinContent(4,1)
    vals["L LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinContent(5,3)
    vals["L LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinContent(5,2)
    vals["L LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinContent(5,1)

    vals["P LM SR lo STC"] = h_LM_SR_23_lo.GetBinContent(1,3)
    vals["P LM SR lo pre"] = h_LM_SR_23_lo.GetBinContent(1,2)
    vals["P LM SR lo obs"] = h_LM_SR_23_lo.GetBinContent(1,1)
    vals["P3 LM SR lo STC"] = h_LM_SR_23_lo.GetBinContent(2,3)
    vals["P3 LM SR lo pre"] = h_LM_SR_23_lo.GetBinContent(2,2)
    vals["P3 LM SR lo obs"] = h_LM_SR_23_lo.GetBinContent(2,1)
    vals["P4 LM SR lo STC"] = h_LM_SR_23_lo.GetBinContent(3,3)
    vals["P4 LM SR lo pre"] = h_LM_SR_23_lo.GetBinContent(3,2)
    vals["P4 LM SR lo obs"] = h_LM_SR_23_lo.GetBinContent(3,1)
    vals["M LM SR lo STC"] = h_LM_SR_23_lo.GetBinContent(4,3)
    vals["M LM SR lo pre"] = h_LM_SR_23_lo.GetBinContent(4,2)
    vals["M LM SR lo obs"] = h_LM_SR_23_lo.GetBinContent(4,1)
    vals["L LM SR lo STC"] = h_LM_SR_23_lo.GetBinContent(5,3)
    vals["L LM SR lo pre"] = h_LM_SR_23_lo.GetBinContent(5,2)
    vals["L LM SR lo obs"] = h_LM_SR_23_lo.GetBinContent(5,1)

    vals["P LH SR lo STC"] = h_LH_SR_23_lo.GetBinContent(1,3)
    vals["P LH SR lo pre"] = h_LH_SR_23_lo.GetBinContent(1,2)
    vals["P LH SR lo obs"] = h_LH_SR_23_lo.GetBinContent(1,1)
    vals["P3 LH SR lo STC"] = h_LH_SR_23_lo.GetBinContent(2,3)
    vals["P3 LH SR lo pre"] = h_LH_SR_23_lo.GetBinContent(2,2)
    vals["P3 LH SR lo obs"] = h_LH_SR_23_lo.GetBinContent(2,1)
    vals["P4 LH SR lo STC"] = h_LH_SR_23_lo.GetBinContent(3,3)
    vals["P4 LH SR lo pre"] = h_LH_SR_23_lo.GetBinContent(3,2)
    vals["P4 LH SR lo obs"] = h_LH_SR_23_lo.GetBinContent(3,1)
    vals["M LH SR lo STC"] = h_LH_SR_23_lo.GetBinContent(4,3)
    vals["M LH SR lo pre"] = h_LH_SR_23_lo.GetBinContent(4,2)
    vals["M LH SR lo obs"] = h_LH_SR_23_lo.GetBinContent(4,1)
    vals["L LH SR lo STC"] = h_LH_SR_23_lo.GetBinContent(5,3)
    vals["L LH SR lo pre"] = h_LH_SR_23_lo.GetBinContent(5,2)
    vals["L LH SR lo obs"] = h_LH_SR_23_lo.GetBinContent(5,1)

    vals["P HL SR lo STC"] = h_HL_SR_4_lo.GetBinContent(1,3)
    vals["P HL SR lo pre"] = h_HL_SR_4_lo.GetBinContent(1,2)
    vals["P HL SR lo obs"] = h_HL_SR_4_lo.GetBinContent(1,1)
    vals["P3 HL SR lo STC"] = h_HL_SR_4_lo.GetBinContent(2,3)
    vals["P3 HL SR lo pre"] = h_HL_SR_4_lo.GetBinContent(2,2)
    vals["P3 HL SR lo obs"] = h_HL_SR_4_lo.GetBinContent(2,1)
    vals["P4 HL SR lo STC"] = h_HL_SR_4_lo.GetBinContent(3,3)
    vals["P4 HL SR lo pre"] = h_HL_SR_4_lo.GetBinContent(3,2)
    vals["P4 HL SR lo obs"] = h_HL_SR_4_lo.GetBinContent(3,1)
    vals["M HL SR lo STC"] = h_HL_SR_4_lo.GetBinContent(4,3)
    vals["M HL SR lo pre"] = h_HL_SR_4_lo.GetBinContent(4,2)
    vals["M HL SR lo obs"] = h_HL_SR_4_lo.GetBinContent(4,1)
    vals["L HL SR lo STC"] = h_HL_SR_4_lo.GetBinContent(5,3)
    vals["L HL SR lo pre"] = h_HL_SR_4_lo.GetBinContent(5,2)
    vals["L HL SR lo obs"] = h_HL_SR_4_lo.GetBinContent(5,1)

    vals["P HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinContent(1,3)
    vals["P HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinContent(1,2)
    vals["P HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinContent(1,1)
    vals["P3 HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinContent(2,3)
    vals["P3 HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinContent(2,2)
    vals["P3 HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinContent(2,1)
    vals["P4 HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinContent(3,3)
    vals["P4 HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinContent(3,2)
    vals["P4 HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinContent(3,1)
    vals["M HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinContent(4,3)
    vals["M HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinContent(4,2)
    vals["M HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinContent(4,1)
    vals["L HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinContent(5,3)
    vals["L HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinContent(5,2)
    vals["L HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinContent(5,1)

    vals["P HM SR lo STC"] = h_HM_SR_4_lo.GetBinContent(1,3)
    vals["P HM SR lo pre"] = h_HM_SR_4_lo.GetBinContent(1,2)
    vals["P HM SR lo obs"] = h_HM_SR_4_lo.GetBinContent(1,1)
    vals["P3 HM SR lo STC"] = h_HM_SR_4_lo.GetBinContent(2,3)
    vals["P3 HM SR lo pre"] = h_HM_SR_4_lo.GetBinContent(2,2)
    vals["P3 HM SR lo obs"] = h_HM_SR_4_lo.GetBinContent(2,1)
    vals["P4 HM SR lo STC"] = h_HM_SR_4_lo.GetBinContent(3,3)
    vals["P4 HM SR lo pre"] = h_HM_SR_4_lo.GetBinContent(3,2)
    vals["P4 HM SR lo obs"] = h_HM_SR_4_lo.GetBinContent(3,1)
    vals["M HM SR lo STC"] = h_HM_SR_4_lo.GetBinContent(4,3)
    vals["M HM SR lo pre"] = h_HM_SR_4_lo.GetBinContent(4,2)
    vals["M HM SR lo obs"] = h_HM_SR_4_lo.GetBinContent(4,1)
    vals["L HM SR lo STC"] = h_HM_SR_4_lo.GetBinContent(5,3)
    vals["L HM SR lo pre"] = h_HM_SR_4_lo.GetBinContent(5,2)
    vals["L HM SR lo obs"] = h_HM_SR_4_lo.GetBinContent(5,1)

    vals["P HH SR lo STC"] = h_HH_SR_4_lo.GetBinContent(1,3)
    vals["P HH SR lo pre"] = h_HH_SR_4_lo.GetBinContent(1,2)
    vals["P HH SR lo obs"] = h_HH_SR_4_lo.GetBinContent(1,1)
    vals["P3 HH SR lo STC"] = h_HH_SR_4_lo.GetBinContent(2,3)
    vals["P3 HH SR lo pre"] = h_HH_SR_4_lo.GetBinContent(2,2)
    vals["P3 HH SR lo obs"] = h_HH_SR_4_lo.GetBinContent(2,1)
    vals["P4 HH SR lo STC"] = h_HH_SR_4_lo.GetBinContent(3,3)
    vals["P4 HH SR lo pre"] = h_HH_SR_4_lo.GetBinContent(3,2)
    vals["P4 HH SR lo obs"] = h_HH_SR_4_lo.GetBinContent(3,1)
    vals["M HH SR lo STC"] = h_HH_SR_4_lo.GetBinContent(4,3)
    vals["M HH SR lo pre"] = h_HH_SR_4_lo.GetBinContent(4,2)
    vals["M HH SR lo obs"] = h_HH_SR_4_lo.GetBinContent(4,1)
    vals["L HH SR lo STC"] = h_HH_SR_4_lo.GetBinContent(5,3)
    vals["L HH SR lo pre"] = h_HH_SR_4_lo.GetBinContent(5,2)
    vals["L HH SR lo obs"] = h_HH_SR_4_lo.GetBinContent(5,1)

    # SR Errors
    errs["P LL SR STC"] = h_LL_SR_23.GetBinError(1,3)
    errs["P LL SR pre"] = h_LL_SR_23.GetBinError(1,2)
    errs["P LL SR obs"] = h_LL_SR_23.GetBinError(1,1)
    errs["P3 LL SR STC"] = h_LL_SR_23.GetBinError(2,3)
    errs["P3 LL SR pre"] = h_LL_SR_23.GetBinError(2,2)
    errs["P3 LL SR obs"] = h_LL_SR_23.GetBinError(2,1)
    errs["P4 LL SR STC"] = h_LL_SR_23.GetBinError(3,3)
    errs["P4 LL SR pre"] = h_LL_SR_23.GetBinError(3,2)
    errs["P4 LL SR obs"] = h_LL_SR_23.GetBinError(3,1)
    errs["M LL SR STC"] = h_LL_SR_23.GetBinError(4,3)
    errs["M LL SR pre"] = h_LL_SR_23.GetBinError(4,2)
    errs["M LL SR obs"] = h_LL_SR_23.GetBinError(4,1)
    errs["L LL SR STC"] = h_LL_SR_23.GetBinError(5,3)
    errs["L LL SR pre"] = h_LL_SR_23.GetBinError(5,2)
    errs["L LL SR obs"] = h_LL_SR_23.GetBinError(5,1)

    errs["P LLM SR STC"] = h_LLM_SR_23.GetBinError(1,3)
    errs["P LLM SR pre"] = h_LLM_SR_23.GetBinError(1,2)
    errs["P LLM SR obs"] = h_LLM_SR_23.GetBinError(1,1)
    errs["P3 LLM SR STC"] = h_LLM_SR_23.GetBinError(2,3)
    errs["P3 LLM SR pre"] = h_LLM_SR_23.GetBinError(2,2)
    errs["P3 LLM SR obs"] = h_LLM_SR_23.GetBinError(2,1)
    errs["P4 LLM SR STC"] = h_LLM_SR_23.GetBinError(3,3)
    errs["P4 LLM SR pre"] = h_LLM_SR_23.GetBinError(3,2)
    errs["P4 LLM SR obs"] = h_LLM_SR_23.GetBinError(3,1)
    errs["M LLM SR STC"] = h_LLM_SR_23.GetBinError(4,3)
    errs["M LLM SR pre"] = h_LLM_SR_23.GetBinError(4,2)
    errs["M LLM SR obs"] = h_LLM_SR_23.GetBinError(4,1)
    errs["L LLM SR STC"] = h_LLM_SR_23.GetBinError(5,3)
    errs["L LLM SR pre"] = h_LLM_SR_23.GetBinError(5,2)
    errs["L LLM SR obs"] = h_LLM_SR_23.GetBinError(5,1)

    errs["P LM SR STC"] = h_LM_SR_23.GetBinError(1,3)
    errs["P LM SR pre"] = h_LM_SR_23.GetBinError(1,2)
    errs["P LM SR obs"] = h_LM_SR_23.GetBinError(1,1)
    errs["P3 LM SR STC"] = h_LM_SR_23.GetBinError(2,3)
    errs["P3 LM SR pre"] = h_LM_SR_23.GetBinError(2,2)
    errs["P3 LM SR obs"] = h_LM_SR_23.GetBinError(2,1)
    errs["P4 LM SR STC"] = h_LM_SR_23.GetBinError(3,3)
    errs["P4 LM SR pre"] = h_LM_SR_23.GetBinError(3,2)
    errs["P4 LM SR obs"] = h_LM_SR_23.GetBinError(3,1)
    errs["M LM SR STC"] = h_LM_SR_23.GetBinError(4,3)
    errs["M LM SR pre"] = h_LM_SR_23.GetBinError(4,2)
    errs["M LM SR obs"] = h_LM_SR_23.GetBinError(4,1)
    errs["L LM SR STC"] = h_LM_SR_23.GetBinError(5,3)
    errs["L LM SR pre"] = h_LM_SR_23.GetBinError(5,2)
    errs["L LM SR obs"] = h_LM_SR_23.GetBinError(5,1)

    errs["P LH SR STC"] = h_LH_SR_23.GetBinError(1,3)
    errs["P LH SR pre"] = h_LH_SR_23.GetBinError(1,2)
    errs["P LH SR obs"] = h_LH_SR_23.GetBinError(1,1)
    errs["P3 LH SR STC"] = h_LH_SR_23.GetBinError(2,3)
    errs["P3 LH SR pre"] = h_LH_SR_23.GetBinError(2,2)
    errs["P3 LH SR obs"] = h_LH_SR_23.GetBinError(2,1)
    errs["P4 LH SR STC"] = h_LH_SR_23.GetBinError(3,3)
    errs["P4 LH SR pre"] = h_LH_SR_23.GetBinError(3,2)
    errs["P4 LH SR obs"] = h_LH_SR_23.GetBinError(3,1)
    errs["M LH SR STC"] = h_LH_SR_23.GetBinError(4,3)
    errs["M LH SR pre"] = h_LH_SR_23.GetBinError(4,2)
    errs["M LH SR obs"] = h_LH_SR_23.GetBinError(4,1)
    errs["L LH SR STC"] = h_LH_SR_23.GetBinError(5,3)
    errs["L LH SR pre"] = h_LH_SR_23.GetBinError(5,2)
    errs["L LH SR obs"] = h_LH_SR_23.GetBinError(5,1)

    errs["P HL SR STC"] = h_HL_SR_4.GetBinError(1,3)
    errs["P HL SR pre"] = h_HL_SR_4.GetBinError(1,2)
    errs["P HL SR obs"] = h_HL_SR_4.GetBinError(1,1)
    errs["P3 HL SR STC"] = h_HL_SR_4.GetBinError(2,3)
    errs["P3 HL SR pre"] = h_HL_SR_4.GetBinError(2,2)
    errs["P3 HL SR obs"] = h_HL_SR_4.GetBinError(2,1)
    errs["P4 HL SR STC"] = h_HL_SR_4.GetBinError(3,3)
    errs["P4 HL SR pre"] = h_HL_SR_4.GetBinError(3,2)
    errs["P4 HL SR obs"] = h_HL_SR_4.GetBinError(3,1)
    errs["M HL SR STC"] = h_HL_SR_4.GetBinError(4,3)
    errs["M HL SR pre"] = h_HL_SR_4.GetBinError(4,2)
    errs["M HL SR obs"] = h_HL_SR_4.GetBinError(4,1)
    errs["L HL SR STC"] = h_HL_SR_4.GetBinError(5,3)
    errs["L HL SR pre"] = h_HL_SR_4.GetBinError(5,2)
    errs["L HL SR obs"] = h_HL_SR_4.GetBinError(5,1)

    errs["P HLM SR STC"] = h_HLM_SR_4.GetBinError(1,3)
    errs["P HLM SR pre"] = h_HLM_SR_4.GetBinError(1,2)
    errs["P HLM SR obs"] = h_HLM_SR_4.GetBinError(1,1)
    errs["P3 HLM SR STC"] = h_HLM_SR_4.GetBinError(2,3)
    errs["P3 HLM SR pre"] = h_HLM_SR_4.GetBinError(2,2)
    errs["P3 HLM SR obs"] = h_HLM_SR_4.GetBinError(2,1)
    errs["P4 HLM SR STC"] = h_HLM_SR_4.GetBinError(3,3)
    errs["P4 HLM SR pre"] = h_HLM_SR_4.GetBinError(3,2)
    errs["P4 HLM SR obs"] = h_HLM_SR_4.GetBinError(3,1)
    errs["M HLM SR STC"] = h_HLM_SR_4.GetBinError(4,3)
    errs["M HLM SR pre"] = h_HLM_SR_4.GetBinError(4,2)
    errs["M HLM SR obs"] = h_HLM_SR_4.GetBinError(4,1)
    errs["L HLM SR STC"] = h_HLM_SR_4.GetBinError(5,3)
    errs["L HLM SR pre"] = h_HLM_SR_4.GetBinError(5,2)
    errs["L HLM SR obs"] = h_HLM_SR_4.GetBinError(5,1)

    errs["P HM SR STC"] = h_HM_SR_4.GetBinError(1,3)
    errs["P HM SR pre"] = h_HM_SR_4.GetBinError(1,2)
    errs["P HM SR obs"] = h_HM_SR_4.GetBinError(1,1)
    errs["P3 HM SR STC"] = h_HM_SR_4.GetBinError(2,3)
    errs["P3 HM SR pre"] = h_HM_SR_4.GetBinError(2,2)
    errs["P3 HM SR obs"] = h_HM_SR_4.GetBinError(2,1)
    errs["P4 HM SR STC"] = h_HM_SR_4.GetBinError(3,3)
    errs["P4 HM SR pre"] = h_HM_SR_4.GetBinError(3,2)
    errs["P4 HM SR obs"] = h_HM_SR_4.GetBinError(3,1)
    errs["M HM SR STC"] = h_HM_SR_4.GetBinError(4,3)
    errs["M HM SR pre"] = h_HM_SR_4.GetBinError(4,2)
    errs["M HM SR obs"] = h_HM_SR_4.GetBinError(4,1)
    errs["L HM SR STC"] = h_HM_SR_4.GetBinError(5,3)
    errs["L HM SR pre"] = h_HM_SR_4.GetBinError(5,2)
    errs["L HM SR obs"] = h_HM_SR_4.GetBinError(5,1)

    errs["P HH SR STC"] = h_HH_SR_4.GetBinError(1,3)
    errs["P HH SR pre"] = h_HH_SR_4.GetBinError(1,2)
    errs["P HH SR obs"] = h_HH_SR_4.GetBinError(1,1)
    errs["P3 HH SR STC"] = h_HH_SR_4.GetBinError(2,3)
    errs["P3 HH SR pre"] = h_HH_SR_4.GetBinError(2,2)
    errs["P3 HH SR obs"] = h_HH_SR_4.GetBinError(2,1)
    errs["P4 HH SR STC"] = h_HH_SR_4.GetBinError(3,3)
    errs["P4 HH SR pre"] = h_HH_SR_4.GetBinError(3,2)
    errs["P4 HH SR obs"] = h_HH_SR_4.GetBinError(3,1)
    errs["M HH SR STC"] = h_HH_SR_4.GetBinError(4,3)
    errs["M HH SR pre"] = h_HH_SR_4.GetBinError(4,2)
    errs["M HH SR obs"] = h_HH_SR_4.GetBinError(4,1)
    errs["L HH SR STC"] = h_HH_SR_4.GetBinError(5,3)
    errs["L HH SR pre"] = h_HH_SR_4.GetBinError(5,2)
    errs["L HH SR obs"] = h_HH_SR_4.GetBinError(5,1)

    # hi pt
    errs["P LL SR hi STC"] = h_LL_SR_23_hi.GetBinError(1,3)
    errs["P LL SR hi pre"] = h_LL_SR_23_hi.GetBinError(1,2)
    errs["P LL SR hi obs"] = h_LL_SR_23_hi.GetBinError(1,1)
    errs["P3 LL SR hi STC"] = h_LL_SR_23_hi.GetBinError(2,3)
    errs["P3 LL SR hi pre"] = h_LL_SR_23_hi.GetBinError(2,2)
    errs["P3 LL SR hi obs"] = h_LL_SR_23_hi.GetBinError(2,1)
    errs["P4 LL SR hi STC"] = h_LL_SR_23_hi.GetBinError(3,3)
    errs["P4 LL SR hi pre"] = h_LL_SR_23_hi.GetBinError(3,2)
    errs["P4 LL SR hi obs"] = h_LL_SR_23_hi.GetBinError(3,1)
    errs["M LL SR hi STC"] = h_LL_SR_23_hi.GetBinError(4,3)
    errs["M LL SR hi pre"] = h_LL_SR_23_hi.GetBinError(4,2)
    errs["M LL SR hi obs"] = h_LL_SR_23_hi.GetBinError(4,1)
    errs["L LL SR hi STC"] = h_LL_SR_23_hi.GetBinError(5,3)
    errs["L LL SR hi pre"] = h_LL_SR_23_hi.GetBinError(5,2)
    errs["L LL SR hi obs"] = h_LL_SR_23_hi.GetBinError(5,1)

    errs["P LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinError(1,3)
    errs["P LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinError(1,2)
    errs["P LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinError(1,1)
    errs["P3 LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinError(2,3)
    errs["P3 LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinError(2,2)
    errs["P3 LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinError(2,1)
    errs["P4 LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinError(3,3)
    errs["P4 LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinError(3,2)
    errs["P4 LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinError(3,1)
    errs["M LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinError(4,3)
    errs["M LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinError(4,2)
    errs["M LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinError(4,1)
    errs["L LLM SR hi STC"] = h_LLM_SR_23_hi.GetBinError(5,3)
    errs["L LLM SR hi pre"] = h_LLM_SR_23_hi.GetBinError(5,2)
    errs["L LLM SR hi obs"] = h_LLM_SR_23_hi.GetBinError(5,1)

    errs["P LM SR hi STC"] = h_LM_SR_23_hi.GetBinError(1,3)
    errs["P LM SR hi pre"] = h_LM_SR_23_hi.GetBinError(1,2)
    errs["P LM SR hi obs"] = h_LM_SR_23_hi.GetBinError(1,1)
    errs["P3 LM SR hi STC"] = h_LM_SR_23_hi.GetBinError(2,3)
    errs["P3 LM SR hi pre"] = h_LM_SR_23_hi.GetBinError(2,2)
    errs["P3 LM SR hi obs"] = h_LM_SR_23_hi.GetBinError(2,1)
    errs["P4 LM SR hi STC"] = h_LM_SR_23_hi.GetBinError(3,3)
    errs["P4 LM SR hi pre"] = h_LM_SR_23_hi.GetBinError(3,2)
    errs["P4 LM SR hi obs"] = h_LM_SR_23_hi.GetBinError(3,1)
    errs["M LM SR hi STC"] = h_LM_SR_23_hi.GetBinError(4,3)
    errs["M LM SR hi pre"] = h_LM_SR_23_hi.GetBinError(4,2)
    errs["M LM SR hi obs"] = h_LM_SR_23_hi.GetBinError(4,1)
    errs["L LM SR hi STC"] = h_LM_SR_23_hi.GetBinError(5,3)
    errs["L LM SR hi pre"] = h_LM_SR_23_hi.GetBinError(5,2)
    errs["L LM SR hi obs"] = h_LM_SR_23_hi.GetBinError(5,1)

    errs["P LH SR hi STC"] = h_LH_SR_23_hi.GetBinError(1,3)
    errs["P LH SR hi pre"] = h_LH_SR_23_hi.GetBinError(1,2)
    errs["P LH SR hi obs"] = h_LH_SR_23_hi.GetBinError(1,1)
    errs["P3 LH SR hi STC"] = h_LH_SR_23_hi.GetBinError(2,3)
    errs["P3 LH SR hi pre"] = h_LH_SR_23_hi.GetBinError(2,2)
    errs["P3 LH SR hi obs"] = h_LH_SR_23_hi.GetBinError(2,1)
    errs["P4 LH SR hi STC"] = h_LH_SR_23_hi.GetBinError(3,3)
    errs["P4 LH SR hi pre"] = h_LH_SR_23_hi.GetBinError(3,2)
    errs["P4 LH SR hi obs"] = h_LH_SR_23_hi.GetBinError(3,1)
    errs["M LH SR hi STC"] = h_LH_SR_23_hi.GetBinError(4,3)
    errs["M LH SR hi pre"] = h_LH_SR_23_hi.GetBinError(4,2)
    errs["M LH SR hi obs"] = h_LH_SR_23_hi.GetBinError(4,1)
    errs["L LH SR hi STC"] = h_LH_SR_23_hi.GetBinError(5,3)
    errs["L LH SR hi pre"] = h_LH_SR_23_hi.GetBinError(5,2)
    errs["L LH SR hi obs"] = h_LH_SR_23_hi.GetBinError(5,1)

    errs["P HL SR hi STC"] = h_HL_SR_4_hi.GetBinError(1,3)
    errs["P HL SR hi pre"] = h_HL_SR_4_hi.GetBinError(1,2)
    errs["P HL SR hi obs"] = h_HL_SR_4_hi.GetBinError(1,1)
    errs["P3 HL SR hi STC"] = h_HL_SR_4_hi.GetBinError(2,3)
    errs["P3 HL SR hi pre"] = h_HL_SR_4_hi.GetBinError(2,2)
    errs["P3 HL SR hi obs"] = h_HL_SR_4_hi.GetBinError(2,1)
    errs["P4 HL SR hi STC"] = h_HL_SR_4_hi.GetBinError(3,3)
    errs["P4 HL SR hi pre"] = h_HL_SR_4_hi.GetBinError(3,2)
    errs["P4 HL SR hi obs"] = h_HL_SR_4_hi.GetBinError(3,1)
    errs["M HL SR hi STC"] = h_HL_SR_4_hi.GetBinError(4,3)
    errs["M HL SR hi pre"] = h_HL_SR_4_hi.GetBinError(4,2)
    errs["M HL SR hi obs"] = h_HL_SR_4_hi.GetBinError(4,1)
    errs["L HL SR hi STC"] = h_HL_SR_4_hi.GetBinError(5,3)
    errs["L HL SR hi pre"] = h_HL_SR_4_hi.GetBinError(5,2)
    errs["L HL SR hi obs"] = h_HL_SR_4_hi.GetBinError(5,1)

    errs["P HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinError(1,3)
    errs["P HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinError(1,2)
    errs["P HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinError(1,1)
    errs["P3 HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinError(2,3)
    errs["P3 HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinError(2,2)
    errs["P3 HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinError(2,1)
    errs["P4 HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinError(3,3)
    errs["P4 HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinError(3,2)
    errs["P4 HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinError(3,1)
    errs["M HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinError(4,3)
    errs["M HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinError(4,2)
    errs["M HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinError(4,1)
    errs["L HLM SR hi STC"] = h_HLM_SR_4_hi.GetBinError(5,3)
    errs["L HLM SR hi pre"] = h_HLM_SR_4_hi.GetBinError(5,2)
    errs["L HLM SR hi obs"] = h_HLM_SR_4_hi.GetBinError(5,1)

    errs["P HM SR hi STC"] = h_HM_SR_4_hi.GetBinError(1,3)
    errs["P HM SR hi pre"] = h_HM_SR_4_hi.GetBinError(1,2)
    errs["P HM SR hi obs"] = h_HM_SR_4_hi.GetBinError(1,1)
    errs["P3 HM SR hi STC"] = h_HM_SR_4_hi.GetBinError(2,3)
    errs["P3 HM SR hi pre"] = h_HM_SR_4_hi.GetBinError(2,2)
    errs["P3 HM SR hi obs"] = h_HM_SR_4_hi.GetBinError(2,1)
    errs["P4 HM SR hi STC"] = h_HM_SR_4_hi.GetBinError(3,3)
    errs["P4 HM SR hi pre"] = h_HM_SR_4_hi.GetBinError(3,2)
    errs["P4 HM SR hi obs"] = h_HM_SR_4_hi.GetBinError(3,1)
    errs["M HM SR hi STC"] = h_HM_SR_4_hi.GetBinError(4,3)
    errs["M HM SR hi pre"] = h_HM_SR_4_hi.GetBinError(4,2)
    errs["M HM SR hi obs"] = h_HM_SR_4_hi.GetBinError(4,1)
    errs["L HM SR hi STC"] = h_HM_SR_4_hi.GetBinError(5,3)
    errs["L HM SR hi pre"] = h_HM_SR_4_hi.GetBinError(5,2)
    errs["L HM SR hi obs"] = h_HM_SR_4_hi.GetBinError(5,1)

    errs["P HH SR hi STC"] = h_HH_SR_4_hi.GetBinError(1,3)
    errs["P HH SR hi pre"] = h_HH_SR_4_hi.GetBinError(1,2)
    errs["P HH SR hi obs"] = h_HH_SR_4_hi.GetBinError(1,1)
    errs["P3 HH SR hi STC"] = h_HH_SR_4_hi.GetBinError(2,3)
    errs["P3 HH SR hi pre"] = h_HH_SR_4_hi.GetBinError(2,2)
    errs["P3 HH SR hi obs"] = h_HH_SR_4_hi.GetBinError(2,1)
    errs["P4 HH SR hi STC"] = h_HH_SR_4_hi.GetBinError(3,3)
    errs["P4 HH SR hi pre"] = h_HH_SR_4_hi.GetBinError(3,2)
    errs["P4 HH SR hi obs"] = h_HH_SR_4_hi.GetBinError(3,1)
    errs["M HH SR hi STC"] = h_HH_SR_4_hi.GetBinError(4,3)
    errs["M HH SR hi pre"] = h_HH_SR_4_hi.GetBinError(4,2)
    errs["M HH SR hi obs"] = h_HH_SR_4_hi.GetBinError(4,1)
    errs["L HH SR hi STC"] = h_HH_SR_4_hi.GetBinError(5,3)
    errs["L HH SR hi pre"] = h_HH_SR_4_hi.GetBinError(5,2)
    errs["L HH SR hi obs"] = h_HH_SR_4_hi.GetBinError(5,1)

    # lo pt
    errs["P LL SR lo STC"] = h_LL_SR_23_lo.GetBinError(1,3)
    errs["P LL SR lo pre"] = h_LL_SR_23_lo.GetBinError(1,2)
    errs["P LL SR lo obs"] = h_LL_SR_23_lo.GetBinError(1,1)
    errs["P3 LL SR lo STC"] = h_LL_SR_23_lo.GetBinError(2,3)
    errs["P3 LL SR lo pre"] = h_LL_SR_23_lo.GetBinError(2,2)
    errs["P3 LL SR lo obs"] = h_LL_SR_23_lo.GetBinError(2,1)
    errs["P4 LL SR lo STC"] = h_LL_SR_23_lo.GetBinError(3,3)
    errs["P4 LL SR lo pre"] = h_LL_SR_23_lo.GetBinError(3,2)
    errs["P4 LL SR lo obs"] = h_LL_SR_23_lo.GetBinError(3,1)
    errs["M LL SR lo STC"] = h_LL_SR_23_lo.GetBinError(4,3)
    errs["M LL SR lo pre"] = h_LL_SR_23_lo.GetBinError(4,2)
    errs["M LL SR lo obs"] = h_LL_SR_23_lo.GetBinError(4,1)
    errs["L LL SR lo STC"] = h_LL_SR_23_lo.GetBinError(5,3)
    errs["L LL SR lo pre"] = h_LL_SR_23_lo.GetBinError(5,2)
    errs["L LL SR lo obs"] = h_LL_SR_23_lo.GetBinError(5,1)

    errs["P LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinError(1,3)
    errs["P LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinError(1,2)
    errs["P LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinError(1,1)
    errs["P3 LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinError(2,3)
    errs["P3 LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinError(2,2)
    errs["P3 LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinError(2,1)
    errs["P4 LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinError(3,3)
    errs["P4 LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinError(3,2)
    errs["P4 LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinError(3,1)
    errs["M LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinError(4,3)
    errs["M LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinError(4,2)
    errs["M LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinError(4,1)
    errs["L LLM SR lo STC"] = h_LLM_SR_23_lo.GetBinError(5,3)
    errs["L LLM SR lo pre"] = h_LLM_SR_23_lo.GetBinError(5,2)
    errs["L LLM SR lo obs"] = h_LLM_SR_23_lo.GetBinError(5,1)

    errs["P LM SR lo STC"] = h_LM_SR_23_lo.GetBinError(1,3)
    errs["P LM SR lo pre"] = h_LM_SR_23_lo.GetBinError(1,2)
    errs["P LM SR lo obs"] = h_LM_SR_23_lo.GetBinError(1,1)
    errs["P3 LM SR lo STC"] = h_LM_SR_23_lo.GetBinError(2,3)
    errs["P3 LM SR lo pre"] = h_LM_SR_23_lo.GetBinError(2,2)
    errs["P3 LM SR lo obs"] = h_LM_SR_23_lo.GetBinError(2,1)
    errs["P4 LM SR lo STC"] = h_LM_SR_23_lo.GetBinError(3,3)
    errs["P4 LM SR lo pre"] = h_LM_SR_23_lo.GetBinError(3,2)
    errs["P4 LM SR lo obs"] = h_LM_SR_23_lo.GetBinError(3,1)
    errs["M LM SR lo STC"] = h_LM_SR_23_lo.GetBinError(4,3)
    errs["M LM SR lo pre"] = h_LM_SR_23_lo.GetBinError(4,2)
    errs["M LM SR lo obs"] = h_LM_SR_23_lo.GetBinError(4,1)
    errs["L LM SR lo STC"] = h_LM_SR_23_lo.GetBinError(5,3)
    errs["L LM SR lo pre"] = h_LM_SR_23_lo.GetBinError(5,2)
    errs["L LM SR lo obs"] = h_LM_SR_23_lo.GetBinError(5,1)

    errs["P LH SR lo STC"] = h_LH_SR_23_lo.GetBinError(1,3)
    errs["P LH SR lo pre"] = h_LH_SR_23_lo.GetBinError(1,2)
    errs["P LH SR lo obs"] = h_LH_SR_23_lo.GetBinError(1,1)
    errs["P3 LH SR lo STC"] = h_LH_SR_23_lo.GetBinError(2,3)
    errs["P3 LH SR lo pre"] = h_LH_SR_23_lo.GetBinError(2,2)
    errs["P3 LH SR lo obs"] = h_LH_SR_23_lo.GetBinError(2,1)
    errs["P4 LH SR lo STC"] = h_LH_SR_23_lo.GetBinError(3,3)
    errs["P4 LH SR lo pre"] = h_LH_SR_23_lo.GetBinError(3,2)
    errs["P4 LH SR lo obs"] = h_LH_SR_23_lo.GetBinError(3,1)
    errs["M LH SR lo STC"] = h_LH_SR_23_lo.GetBinError(4,3)
    errs["M LH SR lo pre"] = h_LH_SR_23_lo.GetBinError(4,2)
    errs["M LH SR lo obs"] = h_LH_SR_23_lo.GetBinError(4,1)
    errs["L LH SR lo STC"] = h_LH_SR_23_lo.GetBinError(5,3)
    errs["L LH SR lo pre"] = h_LH_SR_23_lo.GetBinError(5,2)
    errs["L LH SR lo obs"] = h_LH_SR_23_lo.GetBinError(5,1)

    errs["P HL SR lo STC"] = h_HL_SR_4_lo.GetBinError(1,3)
    errs["P HL SR lo pre"] = h_HL_SR_4_lo.GetBinError(1,2)
    errs["P HL SR lo obs"] = h_HL_SR_4_lo.GetBinError(1,1)
    errs["P3 HL SR lo STC"] = h_HL_SR_4_lo.GetBinError(2,3)
    errs["P3 HL SR lo pre"] = h_HL_SR_4_lo.GetBinError(2,2)
    errs["P3 HL SR lo obs"] = h_HL_SR_4_lo.GetBinError(2,1)
    errs["P4 HL SR lo STC"] = h_HL_SR_4_lo.GetBinError(3,3)
    errs["P4 HL SR lo pre"] = h_HL_SR_4_lo.GetBinError(3,2)
    errs["P4 HL SR lo obs"] = h_HL_SR_4_lo.GetBinError(3,1)
    errs["M HL SR lo STC"] = h_HL_SR_4_lo.GetBinError(4,3)
    errs["M HL SR lo pre"] = h_HL_SR_4_lo.GetBinError(4,2)
    errs["M HL SR lo obs"] = h_HL_SR_4_lo.GetBinError(4,1)
    errs["L HL SR lo STC"] = h_HL_SR_4_lo.GetBinError(5,3)
    errs["L HL SR lo pre"] = h_HL_SR_4_lo.GetBinError(5,2)
    errs["L HL SR lo obs"] = h_HL_SR_4_lo.GetBinError(5,1)

    errs["P HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinError(1,3)
    errs["P HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinError(1,2)
    errs["P HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinError(1,1)
    errs["P3 HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinError(2,3)
    errs["P3 HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinError(2,2)
    errs["P3 HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinError(2,1)
    errs["P4 HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinError(3,3)
    errs["P4 HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinError(3,2)
    errs["P4 HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinError(3,1)
    errs["M HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinError(4,3)
    errs["M HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinError(4,2)
    errs["M HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinError(4,1)
    errs["L HLM SR lo STC"] = h_HLM_SR_4_lo.GetBinError(5,3)
    errs["L HLM SR lo pre"] = h_HLM_SR_4_lo.GetBinError(5,2)
    errs["L HLM SR lo obs"] = h_HLM_SR_4_lo.GetBinError(5,1)

    errs["P HM SR lo STC"] = h_HM_SR_4_lo.GetBinError(1,3)
    errs["P HM SR lo pre"] = h_HM_SR_4_lo.GetBinError(1,2)
    errs["P HM SR lo obs"] = h_HM_SR_4_lo.GetBinError(1,1)
    errs["P3 HM SR lo STC"] = h_HM_SR_4_lo.GetBinError(2,3)
    errs["P3 HM SR lo pre"] = h_HM_SR_4_lo.GetBinError(2,2)
    errs["P3 HM SR lo obs"] = h_HM_SR_4_lo.GetBinError(2,1)
    errs["P4 HM SR lo STC"] = h_HM_SR_4_lo.GetBinError(3,3)
    errs["P4 HM SR lo pre"] = h_HM_SR_4_lo.GetBinError(3,2)
    errs["P4 HM SR lo obs"] = h_HM_SR_4_lo.GetBinError(3,1)
    errs["M HM SR lo STC"] = h_HM_SR_4_lo.GetBinError(4,3)
    errs["M HM SR lo pre"] = h_HM_SR_4_lo.GetBinError(4,2)
    errs["M HM SR lo obs"] = h_HM_SR_4_lo.GetBinError(4,1)
    errs["L HM SR lo STC"] = h_HM_SR_4_lo.GetBinError(5,3)
    errs["L HM SR lo pre"] = h_HM_SR_4_lo.GetBinError(5,2)
    errs["L HM SR lo obs"] = h_HM_SR_4_lo.GetBinError(5,1)

    errs["P HH SR lo STC"] = h_HH_SR_4_lo.GetBinError(1,3)
    errs["P HH SR lo pre"] = h_HH_SR_4_lo.GetBinError(1,2)
    errs["P HH SR lo obs"] = h_HH_SR_4_lo.GetBinError(1,1)
    errs["P3 HH SR lo STC"] = h_HH_SR_4_lo.GetBinError(2,3)
    errs["P3 HH SR lo pre"] = h_HH_SR_4_lo.GetBinError(2,2)
    errs["P3 HH SR lo obs"] = h_HH_SR_4_lo.GetBinError(2,1)
    errs["P4 HH SR lo STC"] = h_HH_SR_4_lo.GetBinError(3,3)
    errs["P4 HH SR lo pre"] = h_HH_SR_4_lo.GetBinError(3,2)
    errs["P4 HH SR lo obs"] = h_HH_SR_4_lo.GetBinError(3,1)
    errs["M HH SR lo STC"] = h_HH_SR_4_lo.GetBinError(4,3)
    errs["M HH SR lo pre"] = h_HH_SR_4_lo.GetBinError(4,2)
    errs["M HH SR lo obs"] = h_HH_SR_4_lo.GetBinError(4,1)
    errs["L HH SR lo STC"] = h_HH_SR_4_lo.GetBinError(5,3)
    errs["L HH SR lo pre"] = h_HH_SR_4_lo.GetBinError(5,2)
    errs["L HH SR lo obs"] = h_HH_SR_4_lo.GetBinError(5,1)

    return vals,errs

def makePlot(regions,vals,errs,nonclosure_syst,desc): 
    simplecanvas.cd()
    tl.Clear()
    nregions=len(regions)
    hobs=ROOT.TH1D(desc,desc+";;Normalized Short Track Counts",nregions,0,nregions)
    hobs.SetLineWidth(3)
    hpred=hobs.Clone(hobs.GetName()+"_prediction")
    ptindices = ["dummy0"]
    tag_index = 1
    for region in regions:
        ptindices.append(0 if region.find("lo") >= 0 else 1)
        hpred.GetXaxis().SetBinLabel(tag_index,region)
        pred = vals[region+" pre"]
        perr = errs[region+" pre"]
        obs = vals[region+" obs"]
        oerr = 1.83 if obs == 0 else errs[region+" obs"]
        if obs == 0:
            print "In region",region,"of",desc,", observation was 0, so setting oerr to 1.83"
        if pred > 0:
            hpred.SetBinContent(tag_index,1) # Set pred to 1 and rescale error below
            hpred.SetBinError(tag_index,perr/pred)
            hobs.SetBinContent(tag_index,obs/pred)
            hobs.SetBinError(tag_index,oerr/pred)
        else: # if prediction is 0, just plot the raw counts
            hpred.SetBinContent(tag_index,0)
            hpred.SetBinError(tag_index,perr)
            hobs.SetBinContent(tag_index,obs)
            hobs.SetBinError(tag_index,oerr)
        tag_index += 1    
    hpred.GetXaxis().LabelsOption("v")
    hpred.GetXaxis().SetTitleOffset(4.8)
    hpred.SetMinimum(-0.001)
    hpred.SetMaximum(3)
    hobs.SetLineColor(ROOT.kRed)
    hpred.SetLineColor(ROOT.kBlack)
    hpred_nofill = hpred.Clone(hpred.GetName()+"nofill")
    hpred_syst = hpred.Clone(hpred.GetName()+"_syst")
    for bin in range(1,hpred_syst.GetNbinsX()+1):
        hpred_syst.SetBinError(bin,sqrt(hpred.GetBinError(bin)**2+nonclosure_error[ptindices[bin]]**2)) # nonclosure error is syst/sqrt(prediction)...kinda weird to normalize here
    hpred.SetFillColor(ROOT.kGray)
    hpred_syst.SetFillColor(ROOT.kGray+2)
    tl.AddEntry(hobs,"Observation")
    tl.AddEntry(hpred,"Prediction, with f_{short} Stat & Syst")
    tl.AddEntry(hpred_syst,"Prediction, with Non-closure Syst")
    hpred_syst.Draw("E2")
    hpred.Draw("E2 same")
    hpred_nofill.Draw("hist same")
    hobs.Draw("same E0")
    tl.Draw()
    simplecanvas.SaveAs("{0}/{1}.png".format(plotdir,desc.replace(" ","_")))

def makePlotRaw(regions,vals,errs,nonclosure_error,desc): # Don't rescale counts
    simplecanvas.cd()
    tl.Clear()
    nregions=len(regions)
    hobs=ROOT.TH1D(desc,desc+";;Short Track Counts",nregions,0,nregions)
    hobs.SetLineWidth(3)
    hpred=hobs.Clone(hobs.GetName()+"_prediction")
    ptindices = ["dummy0"]
    tag_index = 1
    for region in regions:
        ptindices.append(0 if region.find("lo") >= 0 else 1)
        hpred.GetXaxis().SetBinLabel(tag_index,region)
        pred = vals[region+" pre"]
        perr = errs[region+" pre"]
        obs = vals[region+" obs"]
        oerr = 1.83 if obs == 0 else errs[region+" obs"]
        if obs == 0:
            print "In region",region,"of",desc,", observation was 0, so setting oerr to 1.83"
        hpred.SetBinContent(tag_index,pred)
        hpred.SetBinError(tag_index,perr)
        hobs.SetBinContent(tag_index,obs)
        hobs.SetBinError(tag_index,oerr)
        tag_index += 1    
    hpred.GetXaxis().LabelsOption("v")
    hpred.GetXaxis().SetTitleOffset(4.8)
    hpred.SetMinimum(-0.001)
    hpred.SetMaximum(2.5*max(hpred.GetMaximum(),hobs.GetMaximum()))
    hobs.SetLineColor(ROOT.kRed)
    hpred.SetLineColor(ROOT.kBlack)
    hpred_nofill = hpred.Clone(hpred.GetName()+"nofill")
    hpred_syst = hpred.Clone(hpred.GetName()+"_syst")
    for bin in range(1,hpred_syst.GetNbinsX()+1):
        hpred_syst.SetBinError(bin,sqrt(hpred.GetBinError(bin)**2+hpred.GetBinContent(bin)*(nonclosure_error[ptindices[bin]])**2))
    hpred.SetFillColor(ROOT.kGray)
    hpred_syst.SetFillColor(ROOT.kGray+2)
    tl.AddEntry(hobs,"Observation")
    tl.AddEntry(hpred,"Prediction, with f_{short} Stat & Syst")
    tl.AddEntry(hpred_syst,"Prediction, with Non-Closure Systematic")
    hpred_syst.Draw("E2")
    hpred.Draw("E2 same")
    hpred_nofill.Draw("hist same")
    hobs.Draw("same E0")
    tl.Draw()
    simplecanvas.SaveAs("{0}/{1}_raw.png".format(plotdir,desc.replace(" ","_")))

def makeSignalPlot(regions,vals_bg,errs_bg,vals_sig,errs_sig, nonclosure_syst, rescale_lumi, desc): # Don't rescale counts
    simplecanvas.cd()
    tl.Clear()
    nregions=len(regions)
    hbg=ROOT.TH1D(desc+"_counts",desc+";;Short Track Counts",nregions,0,nregions)
    hbg.SetLineWidth(3)
    hsig=hbg.Clone(hbg.GetName()+"_withSig")
    ptindices = ["dummy0"]
    tag_index = 1
    for region in regions:
        ptindices.append(0 if region.find("lo") >= 0 else 1)
        hbg.GetXaxis().SetBinLabel(tag_index,region)
        val_sig = vals_sig[region+" obs"] * rescale_lumi
        err_sig = errs_sig[region+" obs"]
        val_bg = vals_bg[region+" pre"]
        err_bg = errs_bg[region+" pre"]
        hbg.SetBinContent(tag_index,val_bg)
        hbg.SetBinError(tag_index,err_bg)
        hsig.SetBinContent(tag_index,val_sig+val_bg) # Add val_bg so sig is sitting atop background, for easy error comparison
        hsig.SetBinError(tag_index,err_sig)
        tag_index += 1    
    hbg.GetXaxis().LabelsOption("v")
    hbg.GetXaxis().SetTitleOffset(4.8)
    hbg.SetMinimum(-0.001)
    hbg.SetMaximum(2.5*hsig.GetMaximum())
    hsig.SetLineColor(ROOT.kRed)
    hbg.SetLineColor(ROOT.kBlack)
    hbg_nofill = hbg.Clone(hbg.GetName()+"nofill")
    hbg_syst = hbg.Clone(hbg.GetName()+"_syst")
    for bin in range(1,hbg.GetNbinsX()+1):
        hbg_syst.SetBinError(bin,sqrt(hbg.GetBinError(bin)**2+hbg.GetBinContent(bin)*(nonclosure_syst[ptindices[bin]])**2))
    hbg.SetFillColor(ROOT.kGray)
    hbg_syst.SetFillColor(ROOT.kGray+2)
    tl.AddEntry(hbg,"Predicted BG")
    tl.AddEntry(hbg_syst,"Predicted BG, with Non-closure Syst")
    tl.AddEntry(hsig,"Signal + Pred BG (Signal MC Errors)")
    hbg_syst.Draw("E2")
    hbg.Draw("E2 same")
    hbg_nofill.Draw("hist same")
    hsig.Draw("same E0")
    tl.Draw()
    simplecanvas.SaveAs("{0}/{1}_counts.png".format(plotdir,desc.replace(" ","_").replace("(","").replace(")","").replace(",","")))

#d18=ROOT.TFile.Open("output_merged/data_2018_{}.root".format(tag))
#d17=ROOT.TFile.Open("output_merged/data_2017_{}.root".format(tag))
d1718=ROOT.TFile.Open("output_merged/data_2017and2018_{}_{}.root".format(tag,syststring))
d16=ROOT.TFile.Open("output_merged/data_2016_{}_{}.root".format(tag,syststring))
m17=ROOT.TFile.Open("output_merged/mc_2017_{}_{}.root".format(tag,syststring))
m16=ROOT.TFile.Open("output_merged/mc_2016_{}_{}.root".format(tag,syststring))

sig1718 = {}
sig1718[(1800,1400,10)]=ROOT.TFile("output_unmerged/2017_{0}/signal/fastsim_10cm_1800-1400.root".format(tag))
sig1718[(1800,1600,10)]=ROOT.TFile("output_unmerged/2017_{0}/signal/fastsim_10cm_1800-1600.root".format(tag))
sig1718[(1800,1700,10)]=ROOT.TFile("output_unmerged/2017_{0}/signal/fastsim_10cm_1800-1700.root".format(tag))
sig1718[(1800,1400,90)]=ROOT.TFile("output_unmerged/2017_{0}/signal/fastsim_90cm_1800-1400.root".format(tag))
sig1718[(1800,1600,90)]=ROOT.TFile("output_unmerged/2017_{0}/signal/fastsim_90cm_1800-1600.root".format(tag))
sig1718[(1800,1700,90)]=ROOT.TFile("output_unmerged/2017_{0}/signal/fastsim_90cm_1800-1700.root".format(tag))

signal_points=[(1800,1400,10),(1800,1600,10),(1800,1700,10),(1800,1400,90),(1800,1600,90),(1800,1700,90)]

#D18,eD18=getCounts(d18)
#D17,eD17=getCounts(d17)
D1718,eD1718=getCounts(d1718)
D16,eD16=getCounts(d16)
M17,eM17=getCounts(m17)
M16,eM16=getCounts(m16)

S1718 = {}
eS1718 = {}
for sp in signal_points:
    S1718[sp],eS1718[sp] = getCounts(sig1718[sp])
    sig1718[sp].Close()

#D18f,eD18f=getFshorts(d18)
#D17f,eD17f=getFshorts(d17)
D1718f,eD1718f,sD1718f=getFshorts(d1718)
D16f,eD16f,sD16f=getFshorts(d16)
M17f,eM17f,sM17f=getFshorts(m17)
M16f,eM16f,sM16f=getFshorts(m16)

h_nonclosure_syst_D1718_lo = d1718.Get("h_nonclosure_systematic_lo")
h_nonclosure_syst_D1718_hi = d1718.Get("h_nonclosure_systematic_hi")
nonclosure_syst_D1718 = (h_nonclosure_syst_D1718_lo.GetBinContent(1),h_nonclosure_syst_D1718_hi.GetBinContent(1))
h_nonclosure_syst_D16_lo = d16.Get("h_nonclosure_systematic_lo")
h_nonclosure_syst_D16_hi = d16.Get("h_nonclosure_systematic_hi")
nonclosure_syst_D16 = (h_nonclosure_syst_D16_lo.GetBinContent(1),h_nonclosure_syst_D16_hi.GetBinContent(1))
h_nonclosure_syst_M17_lo = m17.Get("h_nonclosure_systematic_lo")
h_nonclosure_syst_M17_hi = m17.Get("h_nonclosure_systematic_hi")
nonclosure_syst_M17 =  (h_nonclosure_syst_M17_lo.GetBinContent(1), h_nonclosure_syst_M17_hi.GetBinContent(1))
h_nonclosure_syst_M16_lo = m16.Get("h_nonclosure_systematic_lo")
h_nonclosure_syst_M16_hi = m16.Get("h_nonclosure_systematic_hi")
nonclosure_syst_M16 = (h_nonclosure_syst_M16_lo.GetBinContent(1),h_nonclosure_syst_M16_hi.GetBinContent(1))

#d18.Close()
#d17.Close()
d1718.Close()
d16.Close()
m17.Close()
m16.Close()

def getMergedCountsLine(region):
    cat = region[0:2]
    if cat == "P ": # don't return 2017-2018
        lumi = 35.9/41.97
        return "{} & - & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D16[region+" pre"], eD16[region+" pre"], S1718[(1800,1400,10)][region+" obs"]*lumi, eS1718[(1800,1400,10)][region+" obs"]*lumi, S1718[(1800,1600,10)][region+" obs"]*lumi, eS1718[(1800,1600,10)][region+" obs"]*lumi, S1718[(1800,1700,10)][region+" obs"]*lumi, eS1718[(1800,1700,10)][region+" obs"]*lumi, S1718[(1800,1400,90)][region+" obs"]*lumi, eS1718[(1800,1400,90)][region+" obs"]*lumi, S1718[(1800,1600,90)][region+" obs"]*lumi, eS1718[(1800,1600,90)][region+" obs"]*lumi, S1718[(1800,1700,90)][region+" obs"]*lumi, eS1718[(1800,1700,90)][region+" obs"]*lumi)
    elif cat == "P3" or cat == "P4": # don't return 2016
        lumi = 1+(58.83/41.97)
        return "{} & {:.3f} $\pm$ {:.3f} & - & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D1718[region+" pre"], eD1718[region+" pre"], S1718[(1800,1400,10)][region+" obs"]*lumi, eS1718[(1800,1400,10)][region+" obs"]*lumi, S1718[(1800,1600,10)][region+" obs"]*lumi, eS1718[(1800,1600,10)][region+" obs"]*lumi, S1718[(1800,1700,10)][region+" obs"]*lumi, eS1718[(1800,1700,10)][region+" obs"]*lumi, S1718[(1800,1400,90)][region+" obs"]*lumi, eS1718[(1800,1400,90)][region+" obs"]*lumi, S1718[(1800,1600,90)][region+" obs"]*lumi, eS1718[(1800,1600,90)][region+" obs"]*lumi, S1718[(1800,1700,90)][region+" obs"]*lumi, eS1718[(1800,1700,90)][region+" obs"]*lumi)
    else:
        lumi = 1+(58.83/41.97)+(35.9/41.97)
        return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D1718[region+" pre"], eD1718[region+" pre"], D16[region+" pre"], eD16[region+" pre"], S1718[(1800,1400,10)][region+" obs"]*lumi, eS1718[(1800,1400,10)][region+" obs"]*lumi, S1718[(1800,1600,10)][region+" obs"]*lumi, eS1718[(1800,1600,10)][region+" obs"]*lumi, S1718[(1800,1700,10)][region+" obs"]*lumi, eS1718[(1800,1700,10)][region+" obs"]*lumi, S1718[(1800,1400,90)][region+" obs"]*lumi, eS1718[(1800,1400,90)][region+" obs"]*lumi, S1718[(1800,1600,90)][region+" obs"]*lumi, eS1718[(1800,1600,90)][region+" obs"]*lumi, S1718[(1800,1700,90)][region+" obs"]*lumi, eS1718[(1800,1700,90)][region+" obs"]*lumi)


def getLineData(region):
    return "{} & {:.3f} $\pm$ {:.3f} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D18[region+" pre"], eD18[region+" pre"], D18[region+" obs"],
                                                                                                                                                                                                                                    D17[region+" pre"], eD17[region+" pre"], D17[region+" obs"],
                                                                                                                                                                                                                                    D16[region+" pre"], eD16[region+" pre"], D16[region+" obs"])

def getLineMC(region):
    return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} \\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    M17[region+" pre"], eM17[region+" pre"], M17[region+" obs"], eM17[region+" obs"],
                                  M16[region+" pre"], eM16[region+" pre"], M16[region+" obs"], eM16[region+" obs"])

def getLineDataSTC(region):
    return "{} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D18[region+" STC"], D18[region+" pre"], eD18[region+" pre"], D18[region+" obs"],
                                                                                                                                                                                                                                    D17[region+" STC"], D17[region+" pre"], eD17[region+" pre"], D17[region+" obs"],
                                                                                                                                                                                                                                    D16[region+" STC"], D16[region+" pre"], eD16[region+" pre"], D16[region+" obs"])

def getLineMCSTC(region):
    return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} \\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    M17[region+" STC"], eM17[region+" STC"], M17[region+" pre"], eM17[region+" pre"], M17[region+" obs"], eM17[region+" obs"],
                                  M16[region+" STC"], eM16[region+" STC"], M16[region+" pre"], eM16[region+" pre"], M16[region+" obs"], eM16[region+" obs"])

def getMergedLineData(region):
    cat = region[0:2]
    if cat == "P ": # don't return 2017-2018
        return "{} & - & - & {:.3f} $\pm$ {:.3f} & {:.0f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D16[region+" pre"], eD16[region+" pre"], D16[region+" obs"])
    elif cat == "P3" or cat == "P4": # don't return 2016
        return "{} & {:.3f} $\pm$ {:.3f} & {:.0f} & - & -\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D1718[region+" pre"], eD1718[region+" pre"], D1718[region+" obs"])
    else:
        return "{} & {:.3f} $\pm$ {:.3f} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D1718[region+" pre"], eD1718[region+" pre"], D1718[region+" obs"],
                                                                                                                                                                                                                                    D16[region+" pre"], eD16[region+" pre"], D16[region+" obs"])

def getMergedLineMC(region):
    cat = region[0:2]
    if cat == "P ": # Don't return 2017-18
        return "{} & - & - & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} \\\\ \n".format(region.replace(" VR","").replace(" SR",""),

                                  M16[region+" pre"], eM16[region+" pre"], M16[region+" obs"], eM16[region+" obs"])

    elif cat == "P3" or cat == "P4": # Don't return 2016
        return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & - & - \\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    M17[region+" pre"], eM17[region+" pre"], M17[region+" obs"], eM17[region+" obs"])
    else:
        return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} \\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    M17[region+" pre"], eM17[region+" pre"], M17[region+" obs"], eM17[region+" obs"],
                                  M16[region+" pre"], eM16[region+" pre"], M16[region+" obs"], eM16[region+" obs"])

def getMergedLineDataSTC(region):
    cat = region[0:2]
    if cat == "P ": # Don't return 2017-18
        return "{} & - & - & - & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D16[region+" STC"], D16[region+" pre"], eD16[region+" pre"], D16[region+" obs"])

    elif cat == "P3" or cat == "P4": # Don't return 2016
        return "{} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f} & - & - & -\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D1718[region+" STC"], D1718[region+" pre"], eD1718[region+" pre"], D1718[region+" obs"])

    else:
        return "{} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f} & {:.0f} & {:.3f} $\pm$ {:.3f} & {:.0f}\\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    D1718[region+" STC"], D1718[region+" pre"], eD1718[region+" pre"], D1718[region+" obs"],
                                                                                                                                                                                                                                    D16[region+" STC"], D16[region+" pre"], eD16[region+" pre"], D16[region+" obs"])

def getMergedLineMCSTC(region):
    cat = region[0:2]
    if cat == "P ": # Don't return 2017-18
        return "{} & - & - & - & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} \\\\ \n".format(region.replace(" VR","").replace(" SR",""),

                                  M16[region+" STC"], eM16[region+" STC"], M16[region+" pre"], eM16[region+" pre"], M16[region+" obs"], eM16[region+" obs"])

    elif cat == "P3" or cat == "P4": # Don't return 2016
        return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & - & - & - \\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    M17[region+" STC"], eM17[region+" STC"], M17[region+" pre"], eM17[region+" pre"], M17[region+" obs"], eM17[region+" obs"])

    else:
        return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} \\\\ \n".format(region.replace(" VR","").replace(" SR",""),
                                                                                                                                                                                                                                    M17[region+" STC"], eM17[region+" STC"], M17[region+" pre"], eM17[region+" pre"], M17[region+" obs"], eM17[region+" obs"],
                                  M16[region+" STC"], eM16[region+" STC"], M16[region+" pre"], eM16[region+" pre"], M16[region+" obs"], eM16[region+" obs"])


def getFSLineData(cat):
    return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f}\\\\ \n".format(cat,D18f[cat],eD18f[cat],D17f[cat],eD17f[cat],D16f[cat],eD16f[cat])

def getFSLineMC(cat):
    return "{} & {:.3f} $\pm$ {:.3f} & {:.3f} $\pm$ {:.3f}\\\\ \n".format(cat,M17f[cat],eM17f[cat],M16f[cat],eM16f[cat])

def getMergedFSLineData(cat):
    subcat = cat[0:2]
    if subcat == "P ": # Don't return 2017-18
        return "{} & - & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst)\\\\ \n".format(cat,D16f[cat],eD16f[cat],sD16f[cat])
    elif subcat == "P3" or subcat == "P4": # don't return 2016
        return "{} & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst) & -\\\\ \n".format(cat,D1718f[cat],eD1718f[cat],sD1718f[cat])
    else:
        return "{} & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst) & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst)\\\\ \n".format(cat,D1718f[cat],eD1718f[cat],sD1718f[cat],D16f[cat],eD16f[cat],sD16f[cat])

def getMergedFSLineMC(cat):
    subcat = cat[0:2]
    if subcat == "P ": # Don't return 2017-18
        return "{} & - & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst)\\\\ \n".format(cat,M16f[cat],eM16f[cat],sM16f[cat])
    elif subcat == "P3" or subcat == "P4": # don't return 2016
        return "{} & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst) & -\\\\ \n".format(cat,M17f[cat],eM17f[cat],sM17f[cat])
    else:
        return "{} & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst) & {:.3f} $\pm$ {:.3f} (stat) $\pm$ {:.3f} (syst) \\\\ \n".format(cat,M17f[cat],eM17f[cat],sM17f[cat],M16f[cat],eM16f[cat],sM16f[cat])

#############
# Make output
#############

#regionsDataNoL16 = [cat + " " + kin + " " + reg + " " + pt for reg in ["VR"] for cat in ["P","M"] for kin in ["LL","HL","LH","HH"] for pt in ["lo","hi"]]
#regionsDataNoL1718 = [cat + " " + kin + " " + reg + " " + pt for reg in ["VR"] for cat in ["P3","P4","M"] for kin in ["LL","HL","LH","HH"] for pt in ["lo","hi"]]
#regionsDataL = ["L " + kin + " VR" for kin in ["LL","LH","HL","HH"]]

regionsP16VR = [cat + " " + kin + " " + reg + " " + pt for reg in ["VR"] for cat in ["P"] for kin in ["LL","LM","LH","HL","HM","HH"] for pt in ["lo","hi"] ]
regionsP16SR = [cat + " " + kin + " " + reg + " " + pt for reg in ["SR"] for cat in ["P"] for kin in ["LL","LM","LH","HL","HM","HH"] for pt in ["lo","hi"] ]
regionsM16VR = [cat + " " + kin + " " + reg + " " + pt for reg in ["VR"] for cat in ["M"] for kin in ["LLM","LH","HLM","HH"] for pt in ["lo","hi"] ]
regionsM16SR = [cat + " " + kin + " " + reg + " " + pt for reg in ["SR"] for cat in ["M"] for kin in ["LLM","LH","HLM","HH"] for pt in ["lo","hi"] ]
regionsNoL1718VR = [cat + " " + kin + " " + reg + " " + pt for reg in ["VR"] for cat in ["P3"] for kin in ["LL","LM","LH","HL","HM","HH"] for pt in ["lo","hi"]]
regionsNoL1718VR += [cat + " " + kin + " " + reg + " " + pt for reg in ["VR"] for cat in ["P4","M"] for kin in ["LLM","LH","HLM","HH"] for pt in ["lo","hi"]]
regionsNoL1718SR = [cat + " " + kin + " " + reg + " " + pt for reg in ["SR"] for cat in ["P3"] for kin in ["LL","LM","LH","HL","HM","HH"] for pt in ["lo","hi"]]
regionsNoL1718SR += [cat + " " + kin + " " + reg + " " + pt for reg in ["SR"] for cat in ["P4","M"] for kin in ["LLM","LH","HLM","HH"] for pt in ["lo","hi"]]
regionsLVR = ["L " + kin + " " + reg for kin in ["LLM","LH","HLM","HH"] for reg in ["VR"]]
regionsLSR = ["L " + kin + " " + reg for kin in ["LLM","LH","HLM","HH"] for reg in ["SR"]]

allVRnoL = regionsP16VR + regionsNoL1718VR
allSRnoL = regionsP16VR + regionsNoL1718SR

allVR1718 = regionsNoL1718VR+regionsLVR
allVR16 = regionsP16VR+regionsM16VR+regionsLVR

allSR1718 = regionsNoL1718SR+regionsLSR
allSR16 = regionsP16SR+regionsM16SR+regionsLSR

allVR = regionsP16VR + regionsNoL1718VR + regionsLVR
allSR = regionsP16SR + regionsNoL1718SR + regionsLSR

allregions = allVR + allSR

makePlotRaw(allVR1718,D1718,eD1718,nonclosure_syst_D1718,"2017-18 DATA VR")
makePlotRaw(allVR16,D16,eD16,nonclosure_syst_D16,"2016 DATA VR")

for sp in signal_points:
    m1=sp[0]
    m2=sp[1]
    ct=sp[2]
    makeSignalPlot(allSR1718,D1718,eD1718,S1718[sp],eS1718[sp],nonclosure_syst_D1718,1+(58.83/41.97),"2017-18 ({}, {}) GeV, {} cm".format(m1,m2,ct))
    makeSignalPlot(allSR16,D16,eD16,S1718[sp],eS1718[sp],nonclosure_syst_D16,35.9/41.97,"2016 ({}, {}) GeV, {} cm".format(m1,m2,ct))

output = open("{0}/counts_data_{1}_SR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedCountsTable(output)
for region in allSR:
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedCountsLine(region))
printFooter(output)
output.close()

output = open("{0}/regions_data_{1}_VR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableData(output)
for region in allVR:
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineData(region))
printFooter(output)
output.close()

output = open("{0}/regions_stc_data_{1}_VR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableDataSTC(output)
for region in allVR:
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineDataSTC(region))
printFooter(output)
output.close()

output = open("{0}/regions_data_{1}_SR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableData(output)
for region in allSR:
    if region.find("VR") >= 0: continue
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineData(region))
printFooter(output)
output.close()

output = open("{0}/regions_stc_data_{1}_SR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableDataSTC(output)
for region in allSR:
    if region.find("VR") >= 0: continue
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineDataSTC(region))
printFooter(output)
output.close()

makePlotRaw(allVR1718,M17,eM17,nonclosure_syst_M17,"2017 MC VR")
makePlotRaw(allVR16,M16,eM16,nonclosure_syst_M16,"2016 MC VR")

makePlotRaw(allSR1718,M17,eM17,nonclosure_syst_M17,"2017 MC SR")
makePlotRaw(allSR16,M16,eM16,nonclosure_syst_M16,"2016 MC SR")

output = open("{0}/regions_mc_{1}_VR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableMC(output)
for region in allVR:
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineMC(region))
printFooter(output)
output.close()

output = open("{0}/regions_stc_mc_{1}_VR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableMCSTC(output)
for region in allVR:
    if region.find("SR") >= 0: continue
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineMCSTC(region))
printFooter(output)
output.close()

output = open("{0}/regions_mc_{1}_SR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableMC(output)
for region in allSR:
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineMC(region))
printFooter(output)
output.close()

output = open("{0}/regions_stc_mc_{1}_SR.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedRegionTableMCSTC(output)
for region in allSR:
    if region[0] == "P":
        output.write("\\rowcolor{green!25}")
    elif region[0] == "M":
        output.write("\\rowcolor{blue!25}")
    else:
        output.write("\\rowcolor{red!25}")
    output.write(getMergedLineMCSTC(region))
printFooter(output)
output.close()


output = open("{0}/fshorts_data_{1}.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedFshortTableData(output)
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P 23 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P 23 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P 4 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P 4 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P3 23 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P3 23 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P3 4 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P3 4 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P4 23 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P4 23 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P4 4 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineData("P4 4 lo"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineData("M 23 hi"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineData("M 23 lo"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineData("M 4 hi"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineData("M 4 lo"))
output.write("\\rowcolor{red!25}")
output.write(getMergedFSLineData("L 23"))
output.write("\\rowcolor{red!25}")
output.write(getMergedFSLineData("L 4"))
printFooter(output)
output.close()

output = open("{0}/fshorts_mc_{1}.tex".format(tabledir,tag),"w")
printHeader(output)
startMergedFshortTableMC(output)
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P 23 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P 23 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P 4 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P 4 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P3 23 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P3 23 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P3 4 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P3 4 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P4 23 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P4 23 lo"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P4 4 hi"))
output.write("\\rowcolor{green!25}")
output.write(getMergedFSLineMC("P4 4 lo"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineMC("M 23 hi"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineMC("M 23 lo"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineMC("M 4 hi"))
output.write("\\rowcolor{blue!25}")
output.write(getMergedFSLineMC("M 4 lo"))
output.write("\\rowcolor{red!25}")
output.write(getMergedFSLineMC("L 23"))
output.write("\\rowcolor{red!25}")
output.write(getMergedFSLineMC("L 4"))
printFooter(output)
output.close()

print "Done"
